---
title: 2. MVC
layout: home
nav_order: 2
parent: 3.1. CRUD avec Laravel
permalink: /laravel-crud/mvc/
code: 3.1.2
competence: C3
autoformation: "C3.1"
ua: "3.1.U1"
duree_h: 1.5
objectif: "Mettre en place un MVC minimal : routes nommées, contrôleur, vues Blade et layout."
notions_nouvelles: ["MVC", "Route nommée", "Contrôleur", "Blade", "Layout", "Partial"]
fil_rouge: "Blog Laravel + App Mobile (Accueil/Liste mock)"
livrable_chapitre: "Pages Accueil/Articles/Détail/À propos avec layout et partials de navigation/flash"
alimentation_prototype: "Structure l’UI du prototype Accueil/Liste"
alimentation_miniprojet: "Navigation de base stable pour le Blog"
---


# 📘  3.1.2 - MVC  (Modèle – Vue – Contrôleur)

## 📒 Glossaire minute

- **MVC** : architecture logicielle qui sépare la logique (Contrôleur), les données (Modèle) et l’affichage (Vue).  
- **Route** : relie une URL à une action du contrôleur.  
- **Contrôleur** : classe qui reçoit la requête, traite la logique et retourne une **vue**.  
- **Blade** : moteur de templates intégré à Laravel pour générer les pages HTML.  
- **Layout** : modèle principal des pages (gabarit).  
- **Partial** : fragment réutilisable de vue (`@include`).  
- **Route nommée** : alias permettant d’appeler une route par son nom (`route('home')`).  

---

## 🎯 Objectif pédagogique

Créer une structure **MVC minimale** :  
➡️ Routes nommées  
➡️ Contrôleur unique (`PageController`)  
➡️ Layout principal + partials (`nav`, `flash`)  
➡️ Vues simples : Accueil, Articles, Détail, À propos  

---

## ✅ Pré-requis
Avoir le projet Laravel fonctionnel (cf. chapitre **3.1.1**)  
et le serveur lancé avec :  

```bash
php artisan serve
```

---

## 🧭 Étapes guidées

### 🧩 Étape 1 — Créer des routes web

**Explication :**
Les routes définissent la correspondance entre une URL et une action (fonction ou méthode du contrôleur).

{% raw %}

```php
// routes/web.php
<?php

use Illuminate\Support\Facades\Route;
use App\Http\Controllers\PageController;

// Route test
Route::get('/ping', fn() => 'pong');

// Routes nommées avec contrôleur
Route::get('/', [PageController::class, 'home'])->name('home');
Route::get('/a-propos', [PageController::class, 'about'])->name('about');

// Mini-routes articles (mockées pour l’instant)
Route::get('/articles', [PageController::class, 'articles'])->name('articles.index');
Route::get('/articles/{slug}', [PageController::class, 'show'])->name('articles.show');
```

{% endraw %}

🔍 **Tester :**

```bash
php artisan route:list
```

👉 Tu dois voir les routes nommées `home`, `articles.index`, `articles.show`, etc.

---

### 🧩 Étape 2 — Créer le contrôleur

**Explication :**
Le contrôleur gère la logique : il décide quelle vue afficher et quelles données lui passer.

```bash
php artisan make:controller PageController
```

`app/Http/Controllers/PageController.php` :

{% raw %}

```php
<?php

namespace App\Http\Controllers;

use Illuminate\View\View;

class PageController extends Controller
{
    private array $ARTICLES = [
        ['id'=>1,'title'=>'Intro Laravel','slug'=>'intro-laravel','views'=>120,'author'=>'Amina'],
        ['id'=>2,'title'=>'PHP 8 en pratique','slug'=>'php-8-en-pratique','views'=>300,'author'=>'Yassine'],
        ['id'=>3,'title'=>'Composer & Autoload','slug'=>'composer-autoload','views'=>90,'author'=>'Sara'],
    ];

    public function home(): View
    {
        return view('home', ['title' => 'Bienvenue sur le Blog Solicode']);
    }

    public function about(): View
    {
        return view('about', ['title' => 'À propos du projet']);
    }

    public function articles(): View
    {
        return view('articles.index', [
            'title'    => 'Articles (sans base de données)',
            'articles' => $this->ARTICLES,
        ]);
    }

    public function show(string $slug): View
    {
        $article = collect($this->ARTICLES)->firstWhere('slug', $slug);
        abort_unless($article, 404);
        return view('articles.show', [
            'title'   => $article['title'],
            'article' => $article,
        ]);
    }
}
```

{% endraw %}

🧠 *Le contrôleur centralise la logique : les vues ne contiennent que de l’affichage.*

---

### 🧩 Étape 3 — Créer le layout et les partials

**Explication :**
Le layout sert de squelette HTML global. Les partials (`nav`, `flash`) sont inclus dans toutes les pages.

`resources/views/layouts/app.blade.php`

{% raw %}

```html
<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>{{ $title ?? config('app.name') }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu;max-width:760px;margin:32px auto;padding:0 16px}
    nav a{margin-right:12px;text-decoration:none}
    .active{font-weight:700;text-decoration:underline}
    .card{padding:16px;border:1px solid #eee;border-radius:12px;margin-bottom:16px}
  </style>
</head>
<body>
  <header>
    <h1>{{ config('app.name', 'Blog Solicode') }}</h1>
    @include('partials.nav')
    <hr>
  </header>

  <main>
    @include('partials.flash')
    @yield('content')
  </main>

  <hr>
  <footer>
    Laravel • {{ now()->format('d/m/Y H:i') }} • {{ config('app.timezone') }}
  </footer>
</body>
</html>
```

{% endraw %}

`resources/views/partials/nav.blade.php`

{% raw %}

```html
<nav>
  <a href="{{ route('home') }}" class="{{ request()->routeIs('home') ? 'active' : '' }}">Accueil</a>
  <a href="{{ route('articles.index') }}" class="{{ request()->routeIs('articles.*') ? 'active' : '' }}">Articles</a>
  <a href="{{ route('about') }}" class="{{ request()->routeIs('about') ? 'active' : '' }}">À propos</a>
</nav>
```

{% endraw %}

`resources/views/partials/flash.blade.php`

{% raw %}

```php
@if (session('success'))
  <p class="card" role="status">{{ session('success') }}</p>
@endif
@if ($errors->any())
  <div class="card" role="alert">
    <strong>Erreurs :</strong>
    <ul>
      @foreach ($errors->all() as $msg)
        <li>{{ $msg }}</li>
      @endforeach
    </ul>
  </div>
@endif
```

{% endraw %}

---

### 🧩 Étape 4 — Créer les vues de contenu

#### 🏠 Accueil

`resources/views/home.blade.php`
{% raw %}

```php
@extends('layouts.app')

@section('content')
  <div class="card">
    <h2>{{ $title }}</h2>
    <p>Bienvenue sur le blog ! Consultez la <a href="{{ route('articles.index') }}">liste des articles</a>.</p>
  </div>
@endsection
```

{% endraw %}

#### ℹ️ À propos

`resources/views/about.blade.php`
{% raw %}

```php
@extends('layouts.app')

@section('content')
  <div class="card">
    <h2>{{ $title }}</h2>
    <p>Ce projet a pour but d’apprendre le modèle MVC avec Laravel et de préparer la mise en place du CRUD.</p>
  </div>
@endsection
```

{% endraw %}

#### 📰 Liste des articles

`resources/views/articles/index.blade.php`
{% raw %}

```php
@extends('layouts.app')

@section('content')
  <h2>{{ $title }}</h2>

  @forelse ($articles as $a)
    <div class="card">
      <h3>
        <a href="{{ route('articles.show', $a['slug']) }}">{{ $a['title'] }}</a>
      </h3>
      <p>Auteur : {{ $a['author'] }} • Vues : {{ $a['views'] }}</p>
    </div>
  @empty
    <p>Aucun article disponible.</p>
  @endforelse
@endsection
```

{% endraw %}

#### 📄 Détail d’un article

`resources/views/articles/show.blade.php`
{% raw %}

```php
@extends('layouts.app')

@section('content')
  <div class="card">
    <h2>{{ $article['title'] }}</h2>
    <p><a href="{{ route('articles.index') }}">← Retour à la liste</a></p>
    <ul>
      <li>Auteur : {{ $article['author'] }}</li>
      <li>Slug : <code>{{ $article['slug'] }}</code></li>
      <li>Vues : {{ $article['views'] }}</li>
    </ul>
  </div>
@endsection
```

{% endraw %}

---

## 🧪 Exercice pratique (livrable N1)

👉 Crée une page **Contact** :

1. Route `GET /contact` → `PageController@contact` (nommée `contact`).
2. Vue `contact.blade.php` étendant `layouts.app`.
3. Lien dans `partials/nav.blade.php` avec mise en surbrillance si actif.
4. Ajouter un formulaire HTML simple (avec `@csrf`), même si l’action POST sera vue plus tard.

---

## ✅ Critères de réussite

* Les routes sont visibles via `php artisan route:list`.
* Les pages Accueil / Articles / Détail / À propos s’affichent sans erreur.
* Le layout est factorisé avec `@extends`, `@include`.
* Les liens utilisent des **routes nommées**.
* Le style et la structure sont cohérents sur toutes les pages.

---

## ⚠️ Erreurs fréquentes

| Erreur                        | Cause                             | Solution                                                  |
| ----------------------------- | --------------------------------- | --------------------------------------------------------- |
| “Class not found”             | `use` manquant pour le contrôleur | Ajouter `use App\Http\Controllers\PageController;`        |
| Vue introuvable               | Mauvais chemin                    | Utiliser la notation `dossier.fichier` (`articles.index`) |
| Changement non pris en compte | Cache des vues                    | `php artisan view:clear`                                  |

---

## 🧾 Résumé

✅ MVC installé et fonctionnel
✅ Routes nommées + contrôleur opérationnel
✅ Layout + partials réutilisables
✅ Navigation de base prête pour les formulaires et le CRUD

---

## 🔜 Suite

👉 Prochain chapitre : **3.1.3 — Formulaires & CSRF**
Tu y apprendras à créer un formulaire sécurisé et à afficher les messages d’erreur avec les helpers Blade.

