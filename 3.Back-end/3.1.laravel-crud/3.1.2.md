---
title: 2. MVC
layout: home
nav_order: 2
parent: 3.1. CRUD avec Laravel
permalink: /laravel-crud/mvc/
code: 3.1.2
competence: C3
autoformation: "C3.1"
ua: "3.1.U1"
duree_h: 1.5
objectif: "Mettre en place un MVC minimal : routes nomm√©es, contr√¥leur, vues Blade et layout."
notions_nouvelles: ["MVC", "Route nomm√©e", "Contr√¥leur", "Blade", "Layout", "Partial"]
fil_rouge: "Blog Laravel + App Mobile (Accueil/Liste mock)"
livrable_chapitre: "Pages Accueil/Articles/D√©tail/√Ä propos avec layout et partials de navigation/flash"
alimentation_prototype: "Structure l‚ÄôUI du prototype Accueil/Liste"
alimentation_miniprojet: "Navigation de base stable pour le Blog"
---


# üìò  3.1.2 - MVC 

## üìí Glossaire minute
- **MVC** : Mod√®le (donn√©es) ‚Ä¢ Vue (affichage) ‚Ä¢ Contr√¥leur (logique).
- **Route** : r√®gle qui associe une **URL** √† une **action** (closure ou m√©thode de contr√¥leur).
- **Contr√¥leur** : classe qui re√ßoit la requ√™te, pr√©pare les donn√©es et **retourne une vue**.
- **Blade** : moteur de templates de Laravel (fichiers `.blade.php`).
- **Layout** : gabarit principal contenant l‚Äôossature HTML et `@yield(...)`.
- **Partial** : morceau de vue r√©utilisable inclus via `@include(...)`.
- **Route nomm√©e** : alias d‚Äôune route (ex. `home`) pour g√©n√©rer des URL avec `route('home')`.

---

## üéØ Objectifs p√©dagogiques
√Ä la fin du chapitre, vous saurez :
1. D√©clarer des **routes** simples et **nomm√©es**.  
2. Cr√©er un **contr√¥leur** et retourner des **vues Blade** avec des **donn√©es**.  
3. Factoriser l‚Äôinterface avec un **layout** et des **partials**.  
4. Utiliser les **helpers Blade** (`@extends`, `@section`, `@include`, `@csrf`, `@error`).

---

## üß± Pr√©-requis
- Projet initialis√© (chapitre **3.1.1**) et serveur lanc√© : `php artisan serve`.

---

## üõ†Ô∏è Tutoriel guid√© (pas √† pas)

### 1) D√©clarer des routes web
`routes/web.php````php
<?php

use Illuminate\Support\Facades\Route;
use App\Http\Controllers\PageController;

// Closure rapide (OK pour tests)
Route::get('/ping', fn() => 'pong');

// Routes nomm√©es via contr√¥leur
Route::get('/', [PageController::class, 'home'])->name('home');
Route::get('/a-propos', [PageController::class, 'about'])->name('about');

// Mini routes "Articles" (sans DB pour l'instant)
Route::get('/articles', [PageController::class, 'articles'])->name('articles.index');
Route::get('/articles/{slug}', [PageController::class, 'show'])->name('articles.show');
```

> Astuce : listez vos routes
>
> ```bash
> php artisan route:list
> ```

---

### 2) Cr√©er le contr√¥leur

```bash
php artisan make:controller PageController
```

`app/Http/Controllers/PageController.php`

```php
<?php

namespace App\Http\Controllers;

use Illuminate\View\View;

class PageController extends Controller
{
    private array $FAKE = [
        ['id'=>1,'title'=>'Intro Laravel','slug'=>'intro-laravel','views'=>120,'author'=>'Amina'],
        ['id'=>2,'title'=>'PHP 8 en pratique','slug'=>'php-8-en-pratique','views'=>300,'author'=>'Yassine'],
        ['id'=>3,'title'=>'Composer & Autoload','slug'=>'composer-autoload','views'=>90,'author'=>'Sara'],
    ];

    public function home(): View
    {
        return view('home', ['title' => 'Bienvenue sur le Blog Solicode']);
    }

    public function about(): View
    {
        return view('about', ['title' => '√Ä propos du projet']);
    }

    public function articles(): View
    {
        return view('articles.index', [
            'title'    => 'Articles (sans DB)',
            'articles' => $this->FAKE,
        ]);
    }

    public function show(string $slug): View
    {
        $article = collect($this->FAKE)->firstWhere('slug', $slug);
        abort_unless($article, 404);
        return view('articles.show', [
            'title'   => $article['title'],
            'article' => $article,
        ]);
    }
}
```

---

### 3) Cr√©er le layout + partials

`resources/views/layouts/app.blade.php`

{% raw %}
```html
<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>{{ $title ?? config('app.name') }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu;max-width:780px;margin:32px auto;padding:0 16px}
    header,footer{opacity:.85}
    nav a{margin-right:12px;text-decoration:none}
    .active{font-weight:700;text-decoration:underline}
    .card{padding:16px;border:1px solid #eee;border-radius:12px;margin-bottom:16px}
  </style>
</head>
<body>
  <header>
    <h1>{{ config('app.name', 'Blog Solicode') }}</h1>
    @include('partials.nav')
    <hr>
  </header>

  <main>
    @include('partials.flash')
    @yield('content')
  </main>

  <hr>
  <footer>
    Laravel ‚Ä¢ {{ now()->format('d/m/Y H:i') }} ‚Ä¢ {{ config('app.timezone') }}
  </footer>
</body>
</html>
```
{% endraw %}`resources/views/partials/nav.blade.php`

{% raw %}
```html
<nav>
  <a href="{{ route('home') }}" class="{{ request()->routeIs('home') ? 'active' : '' }}">Accueil</a>
  <a href="{{ route('articles.index') }}" class="{{ request()->routeIs('articles.*') ? 'active' : '' }}">Articles</a>
  <a href="{{ route('about') }}" class="{{ request()->routeIs('about') ? 'active' : '' }}">√Ä propos</a>
</nav>
```
{% endraw %}

`resources/views/partials/flash.blade.php`

{% raw %}
```php
@if (session('success'))
  <p class="card" role="status">{{ session('success') }}</p>
@endif
@if ($errors->any())
  <div class="card" role="alert">
    <strong>Erreurs :</strong>
    <ul>
      @foreach ($errors->all() as $msg)
        <li>{{ $msg }}</li>
      @endforeach
    </ul>
  </div>
@endif
```
{% endraw %}

---

### 4) Cr√©er les vues de pages

`resources/views/home.blade.php`

{% raw %}
```php
@extends('layouts.app')

@section('content')
  <div class="card">
    <h2>{{ $title }}</h2>
    <p>Bienvenue ! Explorez la liste des <a href="{{ route('articles.index') }}">articles</a>.</p>
  </div>
@endsection
```
{% endraw %}

`resources/views/about.blade.php`

{% raw %}
```php
@extends('layouts.app')

@section('content')
  <div class="card">
    <h2>{{ $title }}</h2>
    <p>Projet p√©dagogique Solicode ‚Äî objectifs : MVC, formulaires, CRUD, API, s√©curit√©.</p>
  </div>
@endsection
```
{% endraw %}

---

### 5) Vues Articles (liste + d√©tail)

`resources/views/articles/index.blade.php`

{% raw %}
```php
@extends('layouts.app')

@section('content')
  <h2>{{ $title }}</h2>

  @forelse ($articles as $a)
    <div class="card">
      <h3>
        <a href="{{ route('articles.show', $a['slug']) }}">
          {{ $a['title'] }}
        </a>
      </h3>
      <p>Auteur : {{ $a['author'] }} ‚Ä¢ Vues : {{ $a['views'] }}</p>
    </div>
  @empty
    <p>Aucun article.</p>
  @endforelse
@endsection
```
{% endraw %}

`resources/views/articles/show.blade.php`

{% raw %}
```php
@extends('layouts.app')

@section('content')
  <div class="card">
    <h2>{{ $article['title'] }}</h2>
    <p><a href="{{ route('articles.index') }}">‚Üê Retour aux articles</a></p>
    <ul>
      <li>Slug : <code>{{ $article['slug'] }}</code></li>
      <li>Auteur : {{ $article['author'] }}</li>
      <li>Vues : {{ $article['views'] }}</li>
    </ul>
  </div>
@endsection
```
{% endraw %}

---

## üß™ Exercice guid√© (livrable N1)

> **But** : ajouter une page **Contact** avec un **formulaire** (HTML simple), affich√©e via un **contr√¥leur** et int√©gr√©e au **layout**.
>
> **Exigences**
>
> 1. Route : `GET /contact` ‚Üí `PageController@contact` (nomm√©e `contact`).
> 2. Vue : `resources/views/contact.blade.php` √©tendant `layouts.app`.
> 3. Lien dans la nav (`partials/nav.blade.php`) avec √©tat **actif**.
> 4. (Pr√©pare la suite) Ajoutez un `@csrf` dans le `<form>` m√™me si l‚Äôaction POST sera cod√©e en 3.1.3.

---

## ‚úÖ Crit√®res de r√©ussite

* Les **routes** s‚Äôaffichent dans `php artisan route:list`.
* Les pages **Accueil**, **Articles**, **D√©tail**, **√Ä propos** s‚Äôaffichent sans erreur.
* Le **layout** est factoris√© et les **partials** sont inclus.
* Les **liens** utilisent des **routes nomm√©es** et l‚Äô√©tat **actif** de la nav fonctionne.

---

## ‚ö†Ô∏è Erreurs fr√©quentes

* Oublier le **namespace** ou le **use** du contr√¥leur dans `web.php`.
* Retourner une **cha√Æne** au lieu d‚Äôune **vue** : utilisez `return view('...')`.
* Mauvais chemins Blade : `views/articles/index.blade.php` se r√©f√©rence par `articles.index`.
* Oublier de **vider le cache des vues** apr√®s des refactors : `php artisan view:clear`.

---

## üßæ R√©sum√©

* **Routes ‚Üí Contr√¥leur ‚Üí Vue** est le flux MVC de base.
* **Layouts** et **partials** √©vitent la duplication d‚ÄôHTML.
* Les **routes nomm√©es** rendent les liens robustes et faciles √† refactorer.

---

## üîú Suite

Passez √† **3.1.3 ‚Äî Formulaires, CSRF, sessions (messages d‚Äôerreur)** puis **3.1.4 ‚Äî Validation avec FormRequest** pour s√©curiser les saisies, avant d‚Äôattaquer **Eloquent & CRUD (3.1.5‚Äì3.1.6)**.

