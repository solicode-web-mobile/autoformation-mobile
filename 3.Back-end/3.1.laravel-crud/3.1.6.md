---
title: 6. CRUD & pagination
layout: home
nav_order: 6
parent: 3.1. CRUD avec Laravel
permalink: /laravel-crud/crud-pagination/
code: 3.1.6
competence: C2
autoformation: "C2.1"
ua: "3.1.U3"
duree_h: 2
objectif: "Livrer un CRUD Article minimal avec pagination et messages de confirmation."
notions_nouvelles: ["Resource controller", "Mass assignment", "Method spoofing", "paginate()", "links()", "Route model binding"]
fil_rouge: "Blog Laravel + App Mobile (admin CRUD v1)"
livrable_chapitre: "CRUD complet `Article` (index/create/edit/delete) + pagination + flash"
alimentation_prototype: "Prototype CRUD Article minimal livr√©"
alimentation_miniprojet: "Back-office Articles op√©rationnel"
---


# üìò  3.1.6 - CRUD basique + pagination

## üß† Introduction th√©orique

Le **CRUD** (*Create, Read, Update, Delete*) est un concept fondamental du d√©veloppement web.  
Il repr√©sente les quatre actions principales sur les donn√©es d‚Äôune application :  
1. **Cr√©er** un enregistrement,  
2. **Lire** (afficher) une liste ou un √©l√©ment,  
3. **Mettre √† jour** un enregistrement,  
4. **Supprimer** une donn√©e.  

Dans Laravel, le CRUD s‚Äôappuie sur trois piliers :
- Le **mod√®le Eloquent** (qui g√®re la persistance des donn√©es),
- Le **contr√¥leur resource** (qui orchestre les actions),
- Et les **vues Blade** (qui affichent les formulaires et les listes).  

Laravel automatise une grande partie de ce processus gr√¢ce √† ses **Resource Controllers** et √† la **validation via FormRequest**.  
Ce tutoriel te guide pour construire un CRUD complet sur le mod√®le `Article`, avec **pagination**, **redirections** et **messages flash**.

---

## üìí Glossaire minute

- **Resource Controller** : contr√¥leur g√©n√©r√© automatiquement avec les m√©thodes standard CRUD.  
- **Mass Assignment** : cr√©ation rapide d‚Äôun mod√®le via `$model::create($data)` (prot√©g√© par `$fillable`).  
- **Method Spoofing** : permet d‚Äôenvoyer `PUT` ou `DELETE` depuis un formulaire HTML.  
- **Route Model Binding** : injection automatique d‚Äôun mod√®le (`Article $article`) dans une route.  
- **Pagination** : limitation du nombre d‚Äôenregistrements par page via `paginate()`.

---

## üß≠ √âtapes guid√©es

### üß© √âtape 1 ‚Äî D√©clarer les routes

Les routes d√©finissent les URL accessibles dans ton application.  
Le contr√¥leur `resource` cr√©e automatiquement les 7 routes REST n√©cessaires au CRUD.

`routes/web.php`
```php
use Illuminate\Support\Facades\Route;
use App\Http\Controllers\ArticleController;

Route::get('/', fn() => redirect()->route('articles.index'));
Route::resource('articles', ArticleController::class)->except(['show']);
````

Ici, on redirige la racine `/` vers la liste des articles, et on exclut `show()` pour simplifier.

---

### üß© √âtape 2 ‚Äî G√©n√©rer et coder le contr√¥leur

Le contr√¥leur centralise toutes les actions du CRUD :
afficher la liste, cr√©er, enregistrer, modifier, mettre √† jour et supprimer.

```bash
php artisan make:controller ArticleController --resource --model=Article
```

`app/Http/Controllers/ArticleController.php`

```php
<?php

namespace App\Http\Controllers;

use App\Models\Article;
use Illuminate\Support\Str;
use Illuminate\Http\RedirectResponse;
use Illuminate\View\View;
use App\Http\Requests\StoreArticleRequest;
use App\Http\Requests\UpdateArticleRequest;

class ArticleController extends Controller
{
    public function index(): View
    {
        $articles = Article::latest('id')->paginate(5);
        return view('articles.index', compact('articles'));
    }

    public function create(): View
    {
        return view('articles.create');
    }

    public function store(StoreArticleRequest $request): RedirectResponse
    {
        $data = $request->validated();
        $data['slug'] ??= Str::slug($data['title']);
        Article::create($data);

        return redirect()->route('articles.index')
            ->with('status', '‚úÖ Article cr√©√© avec succ√®s.');
    }

    public function edit(Article $article): View
    {
        return view('articles.edit', compact('article'));
    }

    public function update(UpdateArticleRequest $request, Article $article): RedirectResponse
    {
        $data = $request->validated();
        $data['slug'] = $data['slug'] ?: Str::slug($data['title']);
        $article->update($data);

        return redirect()->route('articles.index')
            ->with('status', '‚úèÔ∏è Article mis √† jour.');
    }

    public function destroy(Article $article): RedirectResponse
    {
        $article->delete();
        return redirect()->route('articles.index')
            ->with('status', 'üóëÔ∏è Article supprim√©.');
    }
}
```

Chaque m√©thode correspond √† une action du CRUD :

* `index()` : affiche la liste avec pagination.
* `create()` : retourne le formulaire d‚Äôajout.
* `store()` : enregistre un nouvel article valid√©.
* `edit()` : charge un article existant pour modification.
* `update()` : met √† jour l‚Äôarticle existant.
* `destroy()` : supprime l‚Äôarticle et redirige.

---

### üß© √âtape 3 ‚Äî Rappels sur la validation

Les **FormRequest** permettent de v√©rifier la validit√© des donn√©es avant insertion.
Laravel ex√©cute cette validation automatiquement avant d‚Äôappeler le contr√¥leur.

`app/Http/Requests/StoreArticleRequest.php`

```php
<?php

namespace App\Http\Requests;

use Illuminate\Foundation\Http\FormRequest;

class StoreArticleRequest extends FormRequest
{
    public function authorize(): bool { return true; }

    public function rules(): array
    {
        return [
            'title'   => ['required','string','min:3','max:150'],
            'slug'    => ['nullable','string','max:180','unique:articles,slug'],
            'excerpt' => ['nullable','string','max:255'],
            'content' => ['nullable','string'],
        ];
    }
}
```

Cette √©tape garantit la coh√©rence des donn√©es avant de les ins√©rer en base.

---

### üß© √âtape 4 ‚Äî Cr√©er les vues Blade

#### a) Vue Index (liste + pagination)

Cette vue affiche la liste des articles pagin√©e et les boutons d‚Äôaction.

{% raw %}

```php
@extends('layouts.app')

@section('content')
  <h1>Articles</h1>

  @if (session('status'))
    <div style="background:#e6ffed;border:1px solid #86efac;padding:.5rem;margin-bottom:1rem;">
      {{ session('status') }}
    </div>
  @endif

  <a href="{{ route('articles.create') }}" style="display:inline-block;margin-bottom:1rem;padding:.5rem 1rem;background:#111;color:#fff;text-decoration:none;">+ Nouvel article</a>

  <table style="width:100%;border-collapse:collapse;">
    <thead>
      <tr>
        <th style="border-bottom:1px solid #ccc;text-align:left;">Titre</th>
        <th style="border-bottom:1px solid #ccc;text-align:left;">Slug</th>
        <th style="border-bottom:1px solid #ccc;">Actions</th>
      </tr>
    </thead>
    <tbody>
      @forelse ($articles as $a)
        <tr>
          <td>{{ $a->title }}</td>
          <td>{{ $a->slug }}</td>
          <td style="text-align:center;">
            <a href="{{ route('articles.edit', $a) }}">‚úèÔ∏è</a>
            <form action="{{ route('articles.destroy', $a) }}" method="POST" style="display:inline;">
              @csrf @method('DELETE')
              <button type="submit" onclick="return confirm('Supprimer ?')">üóëÔ∏è</button>
            </form>
          </td>
        </tr>
      @empty
        <tr><td colspan="3">Aucun article disponible.</td></tr>
      @endforelse
    </tbody>
  </table>

  <div style="margin-top:1rem;">
    {{ $articles->links() }}
  </div>
@endsection
```

{% endraw %}

Cette vue d√©montre l‚Äôusage de la **pagination Laravel** (`paginate()` + `links()`).

---

#### b) Formulaire partag√© `_form.blade.php`

{% raw %}

```php
@csrf

<div style="margin-bottom:.75rem;">
  <label for="title">Titre *</label><br>
  <input id="title" name="title" type="text" value="{{ old('title', $article->title ?? '') }}" style="width:100%;padding:.5rem;border:1px solid #ccc;">
  @error('title') <div style="color:#b91c1c;">{{ $message }}</div> @enderror
</div>

<div style="margin-bottom:.75rem;">
  <label for="slug">Slug</label><br>
  <input id="slug" name="slug" type="text" value="{{ old('slug', $article->slug ?? '') }}" style="width:100%;padding:.5rem;border:1px solid #ccc;">
  @error('slug') <div style="color:#b91c1c;">{{ $message }}</div> @enderror
</div>

<div style="margin-bottom:.75rem;">
  <label for="excerpt">Extrait</label><br>
  <input id="excerpt" name="excerpt" type="text" value="{{ old('excerpt', $article->excerpt ?? '') }}" style="width:100%;padding:.5rem;border:1px solid #ccc;">
  @error('excerpt') <div style="color:#b91c1c;">{{ $message }}</div> @enderror
</div>

<div style="margin-bottom:.75rem;">
  <label for="content">Contenu</label><br>
  <textarea id="content" name="content" rows="6" style="width:100%;padding:.5rem;border:1px solid #ccc;">{{ old('content', $article->content ?? '') }}</textarea>
  @error('content') <div style="color:#b91c1c;">{{ $message }}</div> @enderror
</div>
```

{% endraw %}

Ce fichier est inclus √† la fois dans **create** et **edit**, ce qui √©vite la duplication de code.

---

#### c) Vue Create

{% raw %}

```php
@extends('layouts.app')

@section('content')
  <h1>Cr√©er un article</h1>
  <form method="POST" action="{{ route('articles.store') }}" novalidate>
    @include('articles._form')
    <button type="submit" style="padding:.5rem 1rem;background:#111;color:#fff;border:none;">Cr√©er</button>
  </form>
@endsection
```

{% endraw %}

#### d) Vue Edit

{% raw %}

```php
@extends('layouts.app')

@section('content')
  <h1>Modifier : {{ $article->title }}</h1>
  <form method="POST" action="{{ route('articles.update', $article) }}" novalidate>
    @method('PUT')
    @include('articles._form', ['article' => $article])
    <button type="submit" style="padding:.5rem 1rem;background:#111;color:#fff;border:none;">Mettre √† jour</button>
  </form>
@endsection
```

{% endraw %}

---

### üß© √âtape 5 ‚Äî V√©rification

Teste chaque action :

* Index : liste pagin√©e.
* Create : ajout d‚Äôun article avec redirection et message.
* Edit : modification d‚Äôun article.
* Delete : suppression confirm√©e.

Cette √©tape confirme le bon fonctionnement du **cycle CRUD complet**.

---

## ‚öôÔ∏è Erreurs fr√©quentes

* **MassAssignmentException** : `$fillable` oubli√© dans le mod√®le.
* **Pagination vide** : remplacer `get()` par `paginate()`.
* **Message non affich√©** : v√©rifier `session('status')` dans la vue.

---

## üßæ R√©sum√©

Tu as maintenant un **CRUD complet** pour le mod√®le `Article`, avec :

* un **contr√¥leur resource**,
* des **formulaires valid√©s**,
* une **pagination fonctionnelle**,
* et des **messages flash** apr√®s chaque action.

Ce module constitue le **socle du back-office** du Blog Laravel.
La prochaine √©tape (**C3.2**) consistera √† transformer ce CRUD en **API REST** pour la partie mobile.

