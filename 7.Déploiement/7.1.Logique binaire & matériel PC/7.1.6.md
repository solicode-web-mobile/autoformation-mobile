---
title: 6. Fichiers, droits & hygiène
layout: home
nav_order: 6
parent: 7.1. Logique binaire & matériel PC
permalink: /binaire-matériel/fichiers-droits-hygiene/
code: 7.1.6
competence: C7
autoformation: "C7.1"
ua: "7.1.U3"
duree_h: 1.5
objectif: "Lister/modifier les droits essentiels (Linux/Windows), protéger .env et appliquer le moindre privilège pour un projet Web."
notions_nouvelles: ["Chemin (path)", "Propriétaire/Groupe", "rwx", "u/g/o", "chmod", "chown", "umask", "ACL NTFS", "icacls"]
fil_rouge: "Sécuriser le blog Laravel : code en lecture, écriture limitée à storage/ et bootstrap/cache, .env protégé."
livrable_chapitre: "Script de mise au propre des droits (Linux ou Windows), capture de vérification, .env en 600 ou ACL dédiée."
alimentation_prototype: "Projet exécutable avec droits minimaux; erreurs d'écriture résolues pour la démo N2."
alimentation_miniprojet: "Politique de droits reproductible (scripts/ACL) et documentée en README pour N3."
---


# 📘 Chapitre 7.1.6 — Fichiers, droits de base & hygiène

## 📒 Glossaire minute

* **Chemin (path)** : adresse d’un fichier/dossier (`C:\sites\blog` • `/var/www/blog`).
* **Propriétaire / groupe** : compte et groupe « responsables » d’un fichier (Linux).
* **Droits rwx** : **r**ead (lecture), **w**rite (écriture), e**x**ecute (ou « traverser » un dossier).
* **u/g/o** : **u**ser (proprio), **g**roup (groupe), **o**thers (autres).
* **`chmod`** : change les droits (Linux).
* **`chown` / `chgrp`** : change propriétaire / groupe (Linux).
* **`umask`** : masque de création par défaut (Linux).
* **ACL** : liste de contrôle d’accès (Windows NTFS, Linux avancé).

---

## 🎯 Objectif pédagogique

Savoir lister et modifier des **droits de fichiers** essentiels (Linux/Windows) et adopter une **hygiène** de base pour un poste de dev/déploiement Web.

---

## 🧠 Définition théorique (débutant)

### Linux (modèle u/g/o + rwx)

* Un droit est la **somme** de bits : `r=4`, `w=2`, `x=1`.
  Ex. `640` → `u=rw-` (6), `g=r--` (4), `o=---` (0).
* Sur un **dossier**, `x` signifie « **traverser** » (accéder au contenu si on connaît le nom).
  Bon profil minimal : **dossiers 750**, **fichiers 640**.
* **Propriétaire** et **groupe** portent la responsabilité. On évite `777`.

### Windows (NTFS + ACL)

* Droits via **Propriétés → Sécurité** ou **`icacls`** (CLI).
* Permissions utiles : **Lecture & exécution** (RX), **Modification** (M).
* L’héritage propage les droits aux sous-dossiers et fichiers.

---

## 🔍 Exemple appliqué au fil rouge (Blog Laravel)

* Code lisible par le serveur Web, **sans** écriture.
* Répertoires **écrits** par l’app : `storage/` et `bootstrap/cache/` **seulement**.
* Fichier `.env` : présent en local, **hors dépôt Git**, droits **stricts**.

---

## 🛠 Tutoriel pratique

### A) Linux — projet dans `/var/www/blog`

> Remplace `votreuser` par ton utilisateur local.

```bash
# 1) Préparer l’arborescence
sudo mkdir -p /var/www/blog
cd /var/www/blog

# 2) Propriétaire = toi ; Groupe = www-data (serveur Web)
sudo chown -R votreuser:www-data /var/www/blog

# 3) Droits par défaut : dossiers 750, fichiers 640
find . -type d -exec chmod 750 {} \;
find . -type f -exec chmod 640 {} \;

# 4) Répertoires que Laravel doit pouvoir écrire
mkdir -p storage bootstrap/cache
chmod -R 770 storage bootstrap/cache     # u=rwX, g=rwX, o=-
# (option « setgid » pour conserver le groupe sur les nouveaux fichiers)
chmod g+s storage bootstrap/cache

# 5) Renforcer .env (local uniquement)
touch .env
chmod 600 .env

# 6) Vérifier visuellement
ls -l
```

**Pourquoi ?**

* Le serveur (groupe `www-data`) peut **lire** le code et **écrire** uniquement là où c’est nécessaire.
* Personne d’autre (**others**) n’a de droits.

---

### B) Windows — dossier `C:\sites\blog`

> Utilise l’Explorateur **ou** la CLI. Adapte le compte du service Web si besoin.

```bat
REM 1) Créer les dossiers
mkdir C:\sites\blog
cd /d C:\sites\blog
mkdir storage bootstrap\cache

REM 2) Nettoyer l’héritage excessif et remettre propre
icacls C:\sites\blog /inheritance:e

REM 3) Donne Lecture & Exécution au groupe "Users" sur tout le code
icacls C:\sites\blog /grant Users:(OI)(CI)RX /T

REM 4) Autorise la Modification (écriture) uniquement là où l’app en a besoin
icacls C:\sites\blog\storage /grant Users:(OI)(CI)M /T
icacls C:\sites\blog\bootstrap\cache /grant Users:(OI)(CI)M /T

REM 5) Protéger .env si présent
type nul > .env
icacls .env /inheritance:r
icacls .env /grant %USERNAME%:R
```

**Idée clé :** le code = **lecture**, les répertoires « runtime » = **modification**, rien d’autre.

---

## 🧼 Hygiène de base (checklist)

* **Nommage** : minuscules, tirets (`kebab-case`), **pas d’accents/espaces** dans les chemins Web.
* **Pas de secrets en clair** : `.env` local protégé, **jamais commit** (`.gitignore`).
* **Droits minimaux** : éviter `777` ; préférer `750` (dirs) / `640` (fichiers).
* **Répertoires dédiés à l’écriture** : *seulement* `storage/`, `bootstrap/cache/`.
* **Sauvegardes** : exporter config/données régulièrement (voir C7.3/7.4 pour logs & sauvegardes).
* **Nettoyage** : supprimer archives temporaires, *dumps* et fichiers de test avant mise en ligne.

---

## 🧾 Résumé et points-clés

* Comprendre `rwx` et **u/g/o** permet de sécuriser rapidement un projet.
* **Principe du moindre privilège** : lecture pour le code, écriture **uniquement** là où nécessaire.
* `.env` doit rester **local, ignoré par Git** et **restreint** (Linux `600`).
* Windows : utiliser **ACL (icacls)** pour différencier **lecture** du code et **modification** des dossiers runtime.

> Prochaine étape : **C7.2 LAN & adressage IP** — on relie la machine (et son système de fichiers) au réseau.
