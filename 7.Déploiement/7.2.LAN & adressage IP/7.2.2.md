---
title: 2. Segmentation & port
permalink: /deploiement/vlan-ports/
layout: home
nav_order: 2
parent: 7.2. LAN & adressage IP
---

# ðŸ“˜ Chapitre 7.2.2 â€” Segmentation (VLAN â€” aperÃ§u) & notions de port

## ðŸ“’ Glossaire minute
- **VLAN (802.1Q)** : rÃ©seau **logique** isolÃ© au sein dâ€™un mÃªme switch (ex. VLAN10=Admin, VLAN20=InvitÃ©s).  
- **Tag 802.1Q** : Ã©tiquette ajoutÃ©e Ã  la trame Ethernet (contient lâ€™**ID VLAN**).  
- **Port access** : appartient Ã  **un seul VLAN** (trames **non taguÃ©es** cÃ´tÃ© PC).  
- **Port trunk** : transporte **plusieurs VLAN** (**taguÃ©s**) entre Ã©quipements (switchâ†”switch/routeur).  
- **PVID / VLAN natif** : VLAN appliquÃ© aux **trames non taguÃ©es** qui arrivent sur le port.  
- **Inter-VLAN** : routage entre VLANs (via **routeur/L3**).  
- **Voice VLAN** : VLAN dÃ©diÃ© tÃ©lÃ©phonie IP (QoS priorisÃ©e).  

---

## ðŸŽ¯ Objectifs
- Comprendre la **segmentation** en VLAN et lâ€™isolation des domaines de broadcast.  
- Distinguer **access vs trunk**, **tagged vs untagged**, **VLAN natif/PVID**.  
- Lire/dessiner un **schÃ©ma** VLAN simple et repÃ©rer les **ports** Ã  configurer.  
- Identifier les **incidents courants** (VLAN mismatch, natif incohÃ©rent).

## âœ… PrÃ©-requis
- 7.2.1 (switch/routeur, topologies). Lâ€™adressage sera pratiquÃ© en **7.2.3**.

---

## 1) Pourquoi des VLANs ?
- **Isolation** : Admin â‰  InvitÃ©s sur le **mÃªme switch**.  
- **SÃ©curitÃ©** : limiter la diffusion (broadcast), appliquer des rÃ¨gles **inter-VLAN** au niveau L3.  
- **Organisation** : regrouper par service/Ã©tage/usage sans recÃ¢bler.  

```mermaid
flowchart LR
  R[Routeur / L3]:::l3 -- Trunk 802.1Q --> S1[Switch]
  S1 -- VLAN10 (access) --> PC1[PC Admin]
  S1 -- VLAN20 (access) --> PC2[PC InvitÃ©s]
classDef l3 fill:#efe,stroke:#3a3,stroke-width:1px;
````

---

## 2) Modes de port & marquage

* **Access (untagged)** : le port **prÃ©sente** des trames **non taguÃ©es** au PC ; le switch **insÃ¨re/retire** le tag **interne**.
* **Trunk (tagged)** : le port **garde** le tag pour transporter **plusieurs VLAN**.
* **VLAN natif / PVID** : sur un trunk, **un** VLAN (souvent 1) pour les trames **non taguÃ©es** (Ã©viter dâ€™y transporter du trafic sensible).

> **RÃ¨gle simple** :
>
> * Vers un **poste** â†’ **access** (1 VLAN).
> * Vers un **switch/routeur** â†’ **trunk** (plusieurs VLAN).

---

## 3) Routage inter-VLAN (aperÃ§u)

* Les VLANs sont **isolÃ©s** en L2. Pour communiquer, il faut un **routeur/L3** (souvent le cÅ“ur de rÃ©seau) :

  * **SVI** (interface VLAN sur un switch L3), ou
  * **Router-on-a-stick** (un lien trunk vers le routeur avec **sous-interfaces** par VLAN).

```mermaid
flowchart TB
  R[Routeur (sub-interfaces)]:::l3 -- Trunk --> S[Switch]
  S -- VLAN10 access --> A[PC Admin]
  S -- VLAN20 access --> G[PC InvitÃ©s]
  R ---|VLAN10: 192.168.10.1| S
  R ---|VLAN20: 192.168.20.1| S
classDef l3 fill:#efe,stroke:#3a3,stroke-width:1px;
```

---

## 4) Exemples de configuration (gÃ©nÃ©riques)

### 4.1 Linux (hÃ´te taguÃ© pour tests)

```bash
# CrÃ©er une interface VLAN 10 sur eth0
sudo ip link add link eth0 name eth0.10 type vlan id 10
sudo ip addr add 192.168.10.10/24 dev eth0.10
sudo ip link set eth0.10 up
```

### 4.2 Style â€œCisco-likeâ€ (syntaxe indicative)

```text
# DÃ©clarer les VLANs
vlan 10
 name ADMIN
vlan 20
 name INVITES

# Port vers un poste (access VLAN10)
interface Gi0/1
 switchport mode access
 switchport access vlan 10

# Trunk vers switch/routeur
interface Gi0/24
 switchport trunk encapsulation dot1q        # (selon plateforme)
 switchport mode trunk
 switchport trunk allowed vlan 10,20
 switchport trunk native vlan 1              # Ã©viter trafic sensible sur natif
```

> Sur matÃ©riel rÃ©el, la syntaxe varie (Cisco, HP/Aruba, Mikrotikâ€¦). Retenez **les concepts**.

---

## 5) Incidents frÃ©quents & correctifs

* **VLAN mismatch** (lâ€™un en VLAN10, lâ€™autre en VLAN20) â†’ pas de connectivitÃ© : **aligner** VLANs/ports.
* **Natif incohÃ©rent** sur un trunk â†’ fuites/erreurs de trafic **untagged** : **uniformiser** le VLAN natif ou Ã©viter de lâ€™utiliser.
* **Poste sur mauvais VLAN** (port access mal configurÃ©) â†’ IP/DHCP inattendus : corriger le **port access**.
* **Boucle L2** lors dâ€™un ajout de lien â†’ tempÃªte de broadcast : **STP** actif (cf. 7.2.1) et design propre.

---

## 6) Bonnes pratiques express

* **Nommer** les VLANs (ADMIN, INVITES, VOICEâ€¦).
* **Documenter** : tableau *port â†” VLAN/usage*.
* **Limiter** les VLANs **autorisÃ©s** sur chaque trunk (principe du moindre privilÃ¨ge).
* Ã‰viter de transporter du trafic sensible sur le **VLAN natif**.
* **Ã‰tiqueter** prises/patchs et mettre Ã  jour le **plan de brassage**.

---

## ðŸ§ª Exercices (avec attentes)

1. **Cartographier** : listez les ports **access** et **trunk** dâ€™un petit LAN (5â€“10 ports), indiquez les VLANs.
2. **Corriger** un **VLAN mismatch** : on vous donne 2 extrÃ©mitÃ©s, expliquez quoi changer.
3. **Router-on-a-stick** (papier) : proposez les **sous-interfaces** cÃ´tÃ© routeur pour VLAN10/20 (IPs de passerelle).

## ðŸ“¦ Livrables attendus

* SchÃ©ma VLAN (Mermaid ou image) + **tableau des ports** (mode, VLAN, description).
* ProcÃ©dure de **validation** (pings intra-VLAN, DHCP/Statique, test inter-VLAN si prÃ©sent).

## âœ… Check-list (DoD)

* [ ] Je sais quand configurer **access** vs **trunk**.
* [ ] Je comprends **tagged/untagged** et le rÃ´le du **VLAN natif/PVID**.
* [ ] Je peux expliquer un **routage inter-VLAN** simple (SVI ou router-on-a-stick).
* [ ] Jâ€™identifie un **VLAN mismatch** et je propose un correctif.

> **Ã‰tape suivante :** **7.2.3 â€” IPv4, masque, CIDR, passerelle & DNS (aperÃ§u)** pour adresser correctement vos VLANs.
