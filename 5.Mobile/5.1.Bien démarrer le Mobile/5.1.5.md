---
title: 5. APK debug
layout: home
nav_order: 5
parent: 5.1. Bien démarrer le Mobile
permalink: /mobile-onboarding/apk-debug/
code: 5.1.5
competence: C5
autoformation: "C5.1"
ua: "5.1.U2"
duree_h: 1.5
objectif: "Construire un APK debug, l’installer via ADB et livrer README + captures/vidéo de vérification."
notions_nouvelles: ["APK debug", "assembleDebug", "ADB install", "monkey", "SHA-256"]
fil_rouge: "APK installable de HelloCounter pour revue et démo"
livrable_chapitre: "`app-debug.apk` + README (build/install) + 2–3 captures + (option) vidéo ≤ 60s"
alimentation_prototype: "APK prêt à démontrer sur émulateur/appareil (N2)"
alimentation_miniprojet: "Chaîne de build/install reproductible pour livraisons N3"
---


# 📘 5.1.5 - Générer l’**APK debug**

## 📒 Glossaire minute
- **APK** : package Android installable (ici **debug** signé par la clé **debug** auto-générée).
- **assembleDebug** : tâche Gradle qui **build** l’APK de debug.
- **ADB** : *Android Debug Bridge* — installe/lance l’app sur émulateur/appareil.
- **Livrables** : éléments remis (APK, README, captures/vidéo) pour vérifier votre travail.

---

## ✅ Objectif
Obtenir un **APK debug** reproductible, l’**installer** sur émulateur/appareil avec **ADB**, puis **préparer les livrables** (README + captures) pour une évaluation simple et rapide.

---

## 🔧 Pré-requis
- Chapitres **5.1.1–5.1.4** complétés (Studio/SDK/AVD + projet + Git).  
- **Device** détecté par `adb devices` **ou** un **AVD** démarré.

---

## 1) Générer l’**APK debug**

### A) Depuis Android Studio (le plus simple)
1. **Build → Build Bundle(s) / APK(s) → Build APK(s)**  
2. Lien **“locate”** en bas → ouvre le dossier de sortie :
```

app/build/outputs/apk/debug/app-debug.apk

````

### B) En **CLI** (recommandé pour un build reproductible)
```bash
# À la racine du projet
./gradlew clean assembleDebug    # macOS/Linux
gradlew.bat clean assembleDebug  # Windows

# APK généré :
# app/build/outputs/apk/debug/app-debug.apk
````

> ℹ️ L’APK **debug** est signé avec la **clé debug** fournie par l’outil (ne la versionnez pas).
> Pour un store, il faudra une **signature release** (plus tard).

---

## 2) Installer l’APK sur émulateur / appareil

### Option 1 — Via Android Studio

* Dans la barre d’outils, choisissez votre **AVD ou device**, puis **Run ▶** (installe et lance automatiquement).
* Ou utilisez **Device File Explorer** / **App Inspector** pour gérer l’app.

### Option 2 — Via **ADB** (CLI)

```bash
# Lister les devices/AVD connectés
adb devices

# Installer ou mettre à jour l'app (remplacement)
adb install -r app/build/outputs/apk/debug/app-debug.apk

# Lancer l'app (remplacez par votre applicationId)
adb shell monkey -p com.acme.hellocounter -c android.intent.category.LAUNCHER 1
```

**Dépannage installation**

```bash
# Conflit de signature / ancienne app → désinstaller, puis réinstaller
adb uninstall com.acme.hellocounter
adb install app/build/outputs/apk/debug/app-debug.apk

# Downgrade (si versionCode plus élevée déjà installée)
adb install -r -d app/build/outputs/apk/debug/app-debug.apk
```

> Astuce : `applicationId` est défini dans `app/build.gradle.kts` (`defaultConfig { applicationId = "..." }`).

---

## 3) Capturer **captures d’écran** & **courte vidéo**

### A) Outils intégrés (recommandé)

* **Android Studio** : *Running Devices* → icône **Screenshot** / **Screen Record**.
* Émulateur : boutons **camera/record** dans la fenêtre.

### B) Via **ADB**

```bash
# Capture d'écran (sauvegarde sur le device)
adb shell screencap -p /sdcard/screen.png
adb pull /sdcard/screen.png ./captures/screen.png

# Enregistrement vidéo (limité à ~3min)
adb shell screenrecord /sdcard/demo.mp4
# Ctrl+C pour arrêter, puis :
adb pull /sdcard/demo.mp4 ./captures/demo.mp4
```

**Conseils**

* Fournir 2–3 **captures** (écran d’accueil, interaction “Hello”, compteur).
* Si vidéo : **≤ 60s** ; montrer *ouverture → interaction → résultat*.

---

## 4) Structurer les **livrables** du dépôt

```
HelloCounter/
├─ README.md
├─ app/build/outputs/apk/debug/app-debug.apk     ← (option : livrer séparément)
├─ captures/
│  ├─ screenshot_01_home.png
│  ├─ screenshot_02_greeting.png
│  └─ demo.mp4                                    ← (≤ 60s)
└─ docs/                                          ← (optionnel)
```

### A) **README.md** (modèle court)

````md
# HelloCounter — Android / Jetpack Compose

Mini-app “Hello + Compteur”.

## 🚀 Build & Install
```bash
./gradlew assembleDebug
adb install -r app/build/outputs/apk/debug/app-debug.apk
````

## 📱 Appareil / Émulateur utilisé

* Pixel 7a API 34 (émulateur) / Redmi Note X (Android 13)
* `adb devices` OK

## ✨ Fonctionnalités

* Champ "Prénom" + bouton "Dire bonjour"
* Compteur (− / +) avec règle `count ≥ 0`

## 🖼️ Captures

* Voir dossier `captures/` (2–3 screenshots + demo.mp4)

````

### B) **Nommer** correctement
- `screenshot_XX_<courte-description>.png`  
- `demo.mp4` (ou `.gif` si poids raisonnable)

### C) (Option) **Hashes** pour intégrité
```bash
shasum -a 256 app/build/outputs/apk/debug/app-debug.apk
# → coller la valeur dans le README
````

---

## 5) Vérifications rapides (checklist)

* [ ] `assembleDebug` **OK** (sans erreurs).
* [ ] `app-debug.apk` **présent** au bon chemin.
* [ ] `adb install -r` **réussit** (émulateur **ou** device).
* [ ] L’app **se lance** et affiche **Hello + Compteur**.
* [ ] **README** clair, **captures** ajoutées.

---

## 🩹 Dépannage (FAQ)

* **`device offline` / non listé** → rebrancher, `adb kill-server && adb start-server`, activer *Débogage USB*, accepter l’empreinte RSA.
* **Émulateur lent** → vérifier hyperviseur (WHPX/KVM), fermer autres AVD, réduire la résolution/ram.
* **`INSTALL_FAILED_VERSION_DOWNGRADE`** → ajouter `-d` ou désinstaller l’app.
* **`INSTALL_PARSE_FAILED_NO_CERTIFICATES`** → rebuild (APK corrompu), ne pas modifier l’APK après build.
* **`More than one device/emulator`** → préciser la cible :

  ```bash
  adb -s <serial> install -r app/build/outputs/apk/debug/app-debug.apk
  ```

---

## 📦 Livrables attendus

* **APK debug** (fichier ou lien vers le chemin de build).
* **README** avec commandes **build/install**, device utilisé, fonctionnalités testées.
* **2–3 captures** + (optionnel) **vidéo** ≤ 60s.

---

## ✅ DoD — Definition of Done

* [ ] APK **debug** généré et **installé** via ADB (émulateur **ou** device).
* [ ] L’app **s’ouvre** et fonctionne (Hello + Compteur).
* [ ] **README** + **captures** présents et lisibles.
* [ ] (Bonus) Hash **SHA-256** de l’APK noté dans le README.

---

## ⚡ Cheatsheet

```bash
# Build APK
./gradlew clean assembleDebug

# Installer / réinstaller
adb install -r app/build/outputs/apk/debug/app-debug.apk

# Lancer l'app
adb shell monkey -p com.acme.hellocounter -c android.intent.category.LAUNCHER 1

# Uninstaller (si conflit signature)
adb uninstall com.acme.hellocounter

# Screenshots & vidéo
adb shell screencap -p /sdcard/s1.png && adb pull /sdcard/s1.png ./captures/
adb shell screenrecord /sdcard/demo.mp4 && adb pull /sdcard/demo.mp4 ./captures/
```
