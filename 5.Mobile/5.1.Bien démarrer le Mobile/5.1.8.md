---
title: 8. Finitions
layout: home
nav_order: 8
parent: 5.1. Bien dÃ©marrer le Mobile
permalink: /mobile-onboarding/finitions/
code: 5.1.8
competence: C5
autoformation: "C5.1"
ua: "5.1.U3"
duree_h: 1.5
objectif: "Finaliser lâ€™UI (Material 3, strings, a11y) et valider un build APK de dÃ©monstration."
notions_nouvelles: ["Material 3", "Dynamic color", "strings.xml", "AccessibilitÃ© (a11y)"]
fil_rouge: "App Mobile prÃ©sentable et accessible (HelloCounter) â€” base de validation"
livrable_chapitre: "`AppTheme` appliquÃ© + `strings.xml` centralisÃ© + actions 48dp + APK debug + README + captures"
alimentation_prototype: "Aspect pro et accessible de la dÃ©mo N2"
alimentation_miniprojet: "UI/a11y consolidÃ©es pour itÃ©rations et intÃ©gration N3"
---


# ğŸ“˜ 5.1.8 - Finitions 


## ğŸ¯ Objectif
Appliquer les **derniÃ¨res finitions** avant livraison :  
- ThÃ¨me **Material 3** propre (avec couleurs dynamiques si dispo).  
- Textes **externalisÃ©s** dans `strings.xml`.  
- **AccessibilitÃ©** minimale (labels, tailles tappables, ordre de focus).  
- GÃ©nÃ©rer et tester un **APK debug** de validation.  

---

## 1) ğŸ¨ ThÃ¨me Material 3

> Fichier : `ui/theme/Theme.kt`

```kotlin
package com.solicode.hellocounter.ui.theme

import android.app.Activity
import android.os.Build
import androidx.compose.foundation.isSystemInDarkTheme
import androidx.compose.material3.MaterialTheme
import androidx.compose.material3.darkColorScheme
import androidx.compose.material3.dynamicDarkColorScheme
import androidx.compose.material3.dynamicLightColorScheme
import androidx.compose.material3.lightColorScheme
import androidx.compose.runtime.Composable
import androidx.compose.ui.platform.LocalContext

private val DarkColorScheme = darkColorScheme(
    primary = Purple80,
    secondary = PurpleGrey80,
    tertiary = Pink80
)

private val LightColorScheme = lightColorScheme(
    primary = Purple40,
    secondary = PurpleGrey40,
    tertiary = Pink40
)

@Composable
fun HelloCounterTheme(
    darkTheme: Boolean = isSystemInDarkTheme(),
    // Dynamic color is available on Android 12+
    dynamicColor: Boolean = true,
    content: @Composable () -> Unit
) {
    val colorScheme = when {
        dynamicColor && Build.VERSION.SDK_INT >= Build.VERSION_CODES.S -> {
            val context = LocalContext.current
            if (darkTheme) dynamicDarkColorScheme(context) else dynamicLightColorScheme(context)
        }

        darkTheme -> DarkColorScheme
        else -> LightColorScheme
    }

    MaterialTheme(
        colorScheme = colorScheme,
        typography = Typography,
        content = content
    )
}
````

**IntÃ©gration (MainActivity.kt)**

```kotlin
setContent { HelloCounterTheme { MainScreen() } }
```

ğŸ”‘ **Explication** :

* `MaterialTheme` applique cohÃ©rence des couleurs, typographie et tailles.
* `dynamicColor` permet dâ€™utiliser la palette Android 12+ si disponible.

---

## 2) ğŸ—‚ï¸ Centraliser les textes

**Chemin** : `res/values/strings.xml`

```xml
<resources>
    <string name="app_name">HelloCounter</string>

    <!-- Formulaire -->
    <string name="label_firstname">PrÃ©nom</string>
    <string name="ph_firstname">Entrez votre prÃ©nom</string>
    <string name="btn_greet">Dire bonjour</string>
    <string name="msg_greeting">Bonjour, %1$s !</string>

    <!-- Compteur -->
    <string name="title_counter">Compteur</string>

    <!-- AccessibilitÃ© -->
    <string name="cd_decrement">Diminuer la valeur</string>
    <string name="cd_increment">Augmenter la valeur</string>
    <string name="cd_counter_value">Valeur actuelle : %1$d</string>
</resources>
```

ğŸ‘‰ Tous les textes visibles ou lus par TalkBack doivent venir dâ€™ici.

---

## 3) â™¿ AccessibilitÃ© (a11y)

* **IcÃ´nes** : ajouter un `contentDescription` (sauf dÃ©coratives â†’ `null`).
* **Tailles tappables** : boutons/icÃ´nes â‰¥ **48.dp**.
* **Ordre de focus** : garanti par la `Column` verticale.
* **TalkBack** : lire lâ€™Ã©cran (Ã©mulateur â†’ *Settings* â†’ *Accessibility*).

Exemple corrigÃ© dans `CompteurSection` :

```kotlin
IconButton(
  onClick = { if (count > 0) count-- },
  enabled = count > 0,
  modifier = Modifier.size(48.dp)
    .semantics { contentDescription = stringResource(R.string.cd_decrement) }
) {
  Icon(Icons.Filled.Remove, contentDescription = null)
}
```

---

## 4) ğŸ§ª VÃ©rifications rapides

* [ ] Tous les composants utilisent **Material 3**.
* [ ] Aucune chaÃ®ne de texte en dur dans le code.
* [ ] Ã‰tats `rememberSaveable` bien appliquÃ©s (`name`, `greetingName`, `count`).
* [ ] `IconButton` et `Button` â‰¥ **48.dp**.
* [ ] Preview et exÃ©cution OK.

---

## 5) ğŸ“¦ GÃ©nÃ©rer un APK debug

**Via Android Studio** :
`Build â†’ Build APK(s)` â†’ fichier gÃ©nÃ©rÃ© dans
`app/build/outputs/apk/debug/app-debug.apk`

**En ligne de commande** :

```bash
./gradlew clean assembleDebug
adb install -r app/build/outputs/apk/debug/app-debug.apk
adb shell monkey -p com.solicode.hellocounter -c android.intent.category.LAUNCHER 1
```

âš ï¸ En cas de conflit :

```bash
adb uninstall com.solicode.hellocounter
```

---

## 6) ğŸ“‘ Livrables

* APK debug (`app-debug.apk`).
* README avec instructions + captures.
* 2â€“3 captures dâ€™Ã©cran de lâ€™appli en exÃ©cution.
* (Optionnel) courte vidÃ©o â‰¤ 60s.

Extrait de README :

````md
## ğŸš€ Build & Install
```bash
./gradlew assembleDebug
adb install -r app/build/outputs/apk/debug/app-debug.apk
````

## ğŸ“± TestÃ© sur

* Pixel 7a API 34 (Ã©mulateur)

## âœ¨ Inclus

* Material 3 + dynamic colors
* AccessibilitÃ© (a11y) : descriptions TalkBack, cibles 48dp
* Ã‰tats persistants (rememberSaveable)

````

---

## âœ… DoD
- [ ] ThÃ¨me `AppTheme` appliquÃ© globalement.  
- [ ] Textes centralisÃ©s dans `strings.xml`.  
- [ ] AccessibilitÃ© validÃ©e (contentDescription, tailles, focus).  
- [ ] APK debug compilÃ© et installable.  
- [ ] README + captures prÃ©sents dans le dÃ©pÃ´t.  

---

## ğŸ©¹ DÃ©pannage
- **Preview vide** â†’ *Build â†’ Rebuild Project*.  
- **Texte non lu par TalkBack** â†’ vÃ©rifier `contentDescription`.  
- **APK non installable** â†’ vÃ©rifier `applicationId`, dÃ©sinstaller version prÃ©cÃ©dente.  
- **Couleurs illisibles** â†’ dÃ©sactiver `dynamicColor` si Android < 12.  

---

## âš¡ Cheatsheet

```kotlin
// ThÃ¨me global
AppTheme { MainScreen() }

// A11y pour icÃ´ne signifiante
.semantics { contentDescription = stringResource(R.string.cd_increment) }

// Build APK
./gradlew assembleDebug
adb install -r app/build/outputs/apk/debug/app-debug.apk
````

