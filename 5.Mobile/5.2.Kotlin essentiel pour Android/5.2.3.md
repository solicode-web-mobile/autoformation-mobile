---
title: 3. Fonctions & lambdas
layout: home
nav_order: 3
parent: 5.2. Kotlin essentiel pour Android
permalink: /kotlin-essentiel/fonctions-lambdas/
code: 5.2.3
competence: C5
autoformation: "C5.2"
ua: "5.2.U2"
duree_h: 1.5
objectif: "Ecrire des fonctions lisibles avec parametres nommes, valeurs par defaut et lambdas simples."
notions_nouvelles: ["Expression body", "Parametres nommes", "Valeurs par defaut", "vararg + spread", "Trailing lambda", "Extensions"]
fil_rouge: "App Mobile Compose + API Blog Laravel"
livrable_chapitre: "`greet(name, punctuation=!)`, `avg(vararg)`, 1 extension, exemple Compose avec callbacks"
alimentation_prototype: "Callbacks Compose clairs (onIncrement/onDecrement) et APIs utilitaires"
alimentation_miniprojet: "Bibliotheque de fonctions reutilisables et testables"
---

# üìò 5.2.3 ‚Äî Fonctions, param√®tres nomm√©s, valeurs par d√©faut, lambdas simples

## üìí Glossaire minute
- **Fonction** : bloc r√©utilisable qui **retourne** (ou non) une valeur.
- **Corps expression** : `fun f() = x` (court, lisible).
- **Param√®tres nomm√©s** : appel explicite `make(title = "OK", cancelable = true)`.
- **Valeurs par d√©faut** : `fun toast(msg: String, long: Boolean = false)`.
- **Lambda** : fonction **anonyme** `{ x -> x + 1 }` ; param√®tre implicite **`it`** si un seul.
- **Trailing lambda** : derni√®re lambda **hors parenth√®ses** : `repeat(3) { println("Hi") }`.
- **Vararg** : nombre d‚Äôarguments variable `fun avg(vararg n: Int)`.

---

## ‚úÖ Objectif
Savoir √©crire des **fonctions lisibles**, utiliser **param√®tres nomm√©s** et **valeurs par d√©faut**, et manipuler des **lambdas** pour des callbacks/usages courants (Collections, Compose).

---

## 1) D√©clarer des fonctions (expression vs bloc)

```kotlin
// Corps expression (pr√©f√©r√© si court)
fun celsiusToF(c: Double) = c * 9 / 5 + 32

// Corps bloc quand il y a plusieurs √©tapes/validations
fun safeDivide(a: Int, b: Int): Double {
  require(b != 0) { "b ne doit pas √™tre 0" }
  return a.toDouble() / b
}
````

> Astuce : Les **fonctions pures** (sans effet de bord) sont plus testables.

---

## 2) Param√®tres nomm√©s & valeurs par d√©faut

```kotlin
fun greet(name: String, punctuation: String = "!") =
  "Bonjour, ${name.trim()}$punctuation"

// Appels
greet("Ada")                       // "Bonjour, Ada!"
greet(name = "Ada", punctuation = " !!") // nomm√©s (lisibilit√©)
```

**√âviter la surcharge inutile** : pr√©f√©rez **un seul** `fun` avec **d√©fauts** plut√¥t que `greet` + `greetLoud`.

**Vararg & spread** :

```kotlin
fun avg(vararg numbers: Int) = numbers.average()
val arr = intArrayOf(1,2,3)
avg(*arr) // spread operator
```

---

## 3) Lambdas simples (syntaxe & usages)

```kotlin
val inc: (Int) -> Int = { x -> x + 1 }
val square = { x: Int -> x * x }     // type inf√©r√© par contexte
val shout: (String) -> String = { it.uppercase() } // it = unique param
```

**Trailing lambda** (Kotlin sugar) :

```kotlin
repeat(3) { println("Yo") }          // au lieu de repeat(3, { ... })
```

**Collections** :

```kotlin
val tags = listOf("android", "kotlin", "compose")
val upper = tags.map { it.uppercase() }.filter { it.startsWith("A") }
```

---

## 4) Android/Compose : callbacks & nomm√©s

```kotlin
@Composable
fun Counter(
  value: Int,
  onIncrement: () -> Unit,
  onDecrement: () -> Unit = {} // d√©faut: no-op
) {
  Row {
    Button(onClick = onDecrement, enabled = value > 0) { Text("‚àí") }
    Text("$value")
    Button(onClick = onIncrement) { Text("+") }
  }
}

// Appel lisible avec nomm√©s
Counter(
  value = count,
  onIncrement = { count++ },
  onDecrement = { if (count > 0) count-- }
)
```

**Param√®tres nomm√©s** am√©liorent la lecture :

```kotlin
Spacer(modifier = Modifier.height(16.dp))
Snackbar(hostState = host, actionOnNewLine = true)
```

---

## 5) Fonctions d‚Äôordre sup√©rieur utiles

```kotlin
inline fun <T> T.alsoLog(tag: String, block: (T) -> Unit = { }) = also {
  println("[$tag] $it")
  block(it)
}

data class Ui(val name: String, val count: Int)

fun nextUi(ui: Ui, inc: Boolean = true) =
  ui.copy(count = if (inc) ui.count + 1 else ui.count)

// Cha√Ænage lisible
val ui2 = Ui("Ada", 0).alsoLog("INIT").let { nextUi(it) }
```

---

## 6) Extensions (optionnel mais tr√®s pratique)

```kotlin
fun String.sanitized() = trim().replace(Regex("\\s+"), " ")
"  Hello   Kotlin  ".sanitized()  // "Hello Kotlin"
```

> Les **extensions** gardent le code lisible sans cr√©er d‚Äôutilitaires verbeux.

---

## 7) Bonnes pratiques & pi√®ges

* Pr√©f√©rez **corps expression** pour les fonctions **courtes**.
* **Param√®tres nomm√©s** pour les appels √† **plusieurs bool√©ens** / options.
* Donnez des **valeurs par d√©faut s√ªres** (`onClick: () -> Unit = {}`).
* **√âvitez** les lambdas avec **effets de bord cach√©s** (surtout en Compose) ; placez la logique d‚Äô√©tat dans le **ViewModel** ou au moins hors du composable.
* N‚Äôabusez pas de **`it`** si le bloc est long ‚Üí **nommez le param√®tre**.

---

## 8) Exemples testables

```kotlin
fun humanize(count: Int, plural: String = "√©l√©ments", singular: String = "√©l√©ment") =
  if (count == 1) "1 $singular" else "$count $plural"

fun <T, R> mapNotNullSafe(list: List<T?>, f: (T) -> R): List<R> =
  list.filterNotNull().map(f)

// Tests rapides (pseudo)
assert(humanize(1) == "1 √©l√©ment")
assert(humanize(2) == "2 √©l√©ments")
assert(mapNotNullSafe(listOf(1, null, 2)) { it * 10 } == listOf(10, 20))
```

---

## üß™ V√©rifications rapides

* [ ] Vous savez √©crire une fonction **courte** en **corps expression**.
* [ ] Vous appelez des fonctions avec **param√®tres nomm√©s** pour la clart√©.
* [ ] Vous utilisez des **valeurs par d√©faut** pour √©viter la surcharge.
* [ ] Vous manipulez des **lambdas** simples (`map/filter/repeat`, callbacks Compose).

---

## ü©π Erreurs fr√©quentes & correctifs

* ‚ùå Multiples surcharges inutiles ‚Üí ‚úÖ **valeurs par d√©faut**.
* ‚ùå Appels confus avec `true/false` ‚Üí ‚úÖ **param√®tres nomm√©s**.
* ‚ùå Lambdas qui modifient de l‚Äô√©tat cach√© ‚Üí ‚úÖ **fonctions pures** ou **intent clair** (ex. `onIncrement()`).
* ‚ùå `return` non-local inattendu dans `forEach` ‚Üí ‚úÖ pr√©f√©rez `for` si besoin de `break/continue`.

---

## üì¶ Livrables attendus

* 1 fichier Kotlin avec :

  * `greet(name: String, punctuation: String = "!")`,
  * `avg(vararg numbers: Int)`,
  * 1 **extension** simple,
  * 1 exemple d‚Äôappel avec **param√®tres nomm√©s** et une **lambda** (Collections **ou** Compose).

---

## ‚úÖ DoD ‚Äî Definition of Done

* [ ] Fonctions **pures** lisibles (expression quand c‚Äôest possible).
* [ ] Param√®tres nomm√©s & valeurs par d√©faut **appropri√©s**.
* [ ] Lambdas **simples** ma√Ætris√©es (callbacks, Collections).
* [ ] Exemple Compose **compilant** avec callbacks par lambda.

---

## ‚ö° Cheatsheet

```kotlin
// Expression body
fun area(w: Int, h: Int) = w * h

// D√©fauts + nomm√©s
fun toast(text: String, long: Boolean = false) = /* ... */
toast(long = true, text = "Saved")

// Lambda & trailing
list.filter { it > 0 }.map { it * 2 }
repeat(3) { println("Hi") }

// Vararg
fun sum(vararg n: Int) = n.sum()
sum(1,2,3)

// Extension
fun String.slug() = lowercase().replace(" ", "-")
"Hello Kotlin".slug() // hello-kotlin
```