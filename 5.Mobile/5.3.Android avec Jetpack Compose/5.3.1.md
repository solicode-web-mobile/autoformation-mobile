---
title: 1. Composables
layout: home
nav_order: 1
parent: 5.3. Android avec Compose
permalink: /android-compose-mvvm/composables/
code: 5.3.1
competence: C5
autoformation: "C5.3"
ua: "5.3.U1"
duree_h: 1.5
objectif: "Afficher texte, bouton, saisie et image puis pr√©visualiser l‚Äô√©cran avec @Preview."
notions_nouvelles: ["Composable", "Modifier", "@Preview", "TextField", "Button"]
fil_rouge: "HelloCounter ‚Äî √©cran Hello + Compteur"
livrable_chapitre: "√âcran combinant Text/Button/TextField/Image + 2 @Preview (Light/Dark)"
alimentation_prototype: "Briques UI de base pr√™tes pour la d√©mo N2"
alimentation_miniprojet: "Composants r√©utilisables et pr√©views standardis√©es pour N3"
---


# üìò 5.3.1 - Composables essentiels

## üìí Glossaire minute
- **Composable** : fonction annot√©e `@Composable` qui **d√©crit l‚ÄôUI** (pas d‚Äôimp√©ratif ‚Äúdessiner‚Äù).
- **`Modifier`** : cha√Æne d‚Äô**op√©rations** (taille, padding, clic, etc.).
- **`@Preview`** : rendu **dans l‚ÄôIDE**, sans lancer l‚Äôapp (rapidit√©).
- **State hoisting** : faire **remonter l‚Äô√©tat** au parent (UI ‚Äúdumb‚Äù).

---

## ‚úÖ Objectif
Savoir **afficher du texte**, **r√©agir √† un clic**, **saisir du texte** et **montrer une image**, puis **pr√©visualiser** l‚Äô√©cran via `@Preview`.

---

## 1) `Text` ‚Äî afficher du texte

```kotlin
@Composable
fun Title(text: String, modifier: Modifier = Modifier) {
  Text(
    text = text,
    style = MaterialTheme.typography.titleLarge,
    modifier = modifier
  )
}
````

**Bonnes pratiques**

* Textes dans `strings.xml` (i18n).
* Styles via `MaterialTheme.typography`.

---

## 2) `Button` ‚Äî action utilisateur

```kotlin
@Composable
fun PrimaryButton(
  label: String,
  enabled: Boolean = true,
  onClick: () -> Unit,
  modifier: Modifier = Modifier
) {
  Button(
    onClick = onClick,
    enabled = enabled,
    modifier = modifier.fillMaxWidth()
  ) {
    Text(label)
  }
}
```

**Guidelines**

* **Action claire** (verbe).
* Largeur/contextes d‚Äôusage coh√©rents.
* **D√©sactivation** si action impossible.

---

## 3) `TextField` ‚Äî saisie de texte (√©tat local simple)

> Pour la **d√©monstration**, on met l‚Äô√©tat dans le composable. En prod, pr√©f√©rez **state hoisting** ou **ViewModel**.

```kotlin
@Composable
fun NameInput(
  value: String,
  onValueChange: (String) -> Unit,
  modifier: Modifier = Modifier
) {
  OutlinedTextField(
    value = value,
    onValueChange = onValueChange,
    label = { Text(stringResource(R.string.label_firstname)) },
    placeholder = { Text(stringResource(R.string.ph_firstname)) },
    singleLine = true,
    keyboardOptions = KeyboardOptions(imeAction = ImeAction.Done),
    modifier = modifier.fillMaxWidth()
  )
}
```

---

## 4) `Image` ‚Äî afficher une ressource

```kotlin
@Composable
fun AppLogo(modifier: Modifier = Modifier) {
  Image(
    painter = painterResource(R.drawable.ic_launcher_foreground),
    contentDescription = stringResource(R.string.cd_app_logo),
    contentScale = ContentScale.Fit,
    modifier = modifier.size(96.dp)
  )
}
```

**Accessibilit√©**

* `contentDescription` **signifiant** si l‚Äôimage porte du sens (sinon `null`).

---

## 5) Exemple d‚Äô√©cran combinant tout

```kotlin
@Composable
fun HelloCounterScreen(modifier: Modifier = Modifier) {
  var name by rememberSaveable { mutableStateOf("") }
  var count by rememberSaveable { mutableStateOf(0) }
  val canGreet = name.isNotBlank()

  Column(
    modifier = modifier
      .fillMaxSize()
      .padding(16.dp),
    verticalArrangement = Arrangement.spacedBy(16.dp)
  ) {
    AppLogo()

    Title(text = stringResource(R.string.app_name))

    NameInput(value = name, onValueChange = { name = it })

    PrimaryButton(
      label = stringResource(R.string.btn_greet),
      enabled = canGreet,
      onClick = { /* afficher un snackbar / message (hors scope ici) */ }
    )

    Text(text = stringResource(R.string.title_counter), style = MaterialTheme.typography.titleMedium)

    Row(
      verticalAlignment = Alignment.CenterVertically,
      horizontalArrangement = Arrangement.spacedBy(12.dp)
    ) {
      IconButton(onClick = { if (count > 0) count-- }, enabled = count > 0) {
        Icon(Icons.Default.Remove, contentDescription = stringResource(R.string.cd_decrement))
      }
      Text(text = "$count", style = MaterialTheme.typography.headlineSmall, modifier = Modifier.widthIn(min = 40.dp))
      IconButton(onClick = { count++ }) {
        Icon(Icons.Default.Add, contentDescription = stringResource(R.string.cd_increment))
      }
    }
  }
}
```

---

## 6) `@Preview` ‚Äî pr√©visualiser dans l‚ÄôIDE

```kotlin
@Preview(showBackground = true, widthDp = 360)
@Composable
fun HelloCounterPreview_Light() {
  MaterialTheme { HelloCounterScreen() }
}

@Preview(showBackground = true, widthDp = 360, uiMode = Configuration.UI_MODE_NIGHT_YES)
@Composable
fun HelloCounterPreview_Dark() {
  MaterialTheme { HelloCounterScreen() }
}
```

**Astuces Preview**

* `showBackground = true` pour un fond gris clair.
* Variantes **Light/Dark**, **petits/ grands** √©crans (changer `widthDp/heightDp`).
* Pas d‚ÄôAPIs Android bloquantes dans un `@Preview` (pr√©f√©rez donn√©es **mock**).

---

## 7) Ressources requises (exemples)

**`strings.xml`**

```xml
<resources>
    <string name="app_name">HelloCounter</string>
    <string name="label_firstname">Pr√©nom</string>
    <string name="ph_firstname">Entrez votre pr√©nom</string>
    <string name="btn_greet">Dire bonjour</string>
    <string name="title_counter">Compteur</string>
    <string name="cd_app_logo">Logo de l'application</string>
    <string name="cd_decrement">Diminuer la valeur</string>
    <string name="cd_increment">Augmenter la valeur</string>
</resources>
```

**D√©pendances (rappel `build.gradle.kts`)**

```kts
dependencies {
  val composeBom = platform("androidx.compose:compose-bom:<latest>")
  implementation(composeBom); androidTestImplementation(composeBom)

  implementation("androidx.activity:activity-compose:1.9.0")
  implementation("androidx.compose.material3:material3")
  implementation("androidx.compose.ui:ui")
  implementation("androidx.compose.ui:ui-tooling-preview")
  implementation("androidx.compose.material:material-icons-extended")
  debugImplementation("androidx.compose.ui:ui-tooling")
}
```

---

## 8) State hoisting (sch√©ma conseill√©)

> √âviter de garder l‚Äô√©tat **dans** le composable final. Passer `value` + `onValueChange` depuis le parent (ou `ViewModel`).

```kotlin
@Composable
fun GreetingSection(
  name: String,
  onNameChange: (String) -> Unit,
  onGreet: () -> Unit
) {
  NameInput(value = name, onValueChange = onNameChange)
  PrimaryButton(label = stringResource(R.string.btn_greet), enabled = name.isNotBlank(), onClick = onGreet)
}
```

---

## üß™ V√©rifications rapides

* [ ] `Text`, `Button`, `TextField`, `Image` affichent et r√©agissent correctement.
* [ ] `contentDescription` **pr√©sent** si l‚Äôimage a du sens.
* [ ] `@Preview` Light/Dark **fonctionnels**.
* [ ] `Modifier` utilis√© proprement (`fillMaxWidth()`, `padding(16.dp)`, etc.).

---

## ü©π D√©pannage

* **Preview vide** ‚Üí *Build ‚Üí Rebuild Project*, `@Preview(showBackground = true)`, √©viter code n√©cessitant un `Context` r√©el.
* **Ic√¥nes non r√©solues** ‚Üí ajouter `material-icons-extended`.
* **Texte ‚Äúen dur‚Äù** ‚Üí d√©placer vers `strings.xml`.
* **Bouton non cliquable** ‚Üí v√©rifier `enabled` et que **aucun composant** ne consomme le clic au-dessus.

---

## üì¶ Livrables attendus

* Un √©cran combinant **Text / Button / TextField / Image**.
* Deux `@Preview` (clair/sombre) affichables.
* `strings.xml` mis √† jour + `contentDescription` utiles.

---

## ‚úÖ DoD ‚Äî Definition of Done

* [ ] √âcran **Compose** compilant, √©l√©ments de base pr√©sents.
* [ ] UI **accessible** (descriptions, tailles tappables par d√©faut).
* [ ] **Pr√©views** Light/Dark OK.
* [ ] Textes **externalis√©s** dans `strings.xml`.

---

## ‚ö° Cheatsheet

```kotlin
// Text
Text("Hello", style = MaterialTheme.typography.titleLarge)

// Button
Button(onClick = { /* ... */ }, enabled = true) { Text("OK") }

// TextField
OutlinedTextField(value = name, onValueChange = { name = it }, singleLine = true)

// Image
Image(painterResource(R.drawable.ic_launcher_foreground), contentDescription = "Logo")

// Preview
@Preview(showBackground = true) @Composable fun Prev() { MaterialTheme { HelloCounterScreen() } }
```
