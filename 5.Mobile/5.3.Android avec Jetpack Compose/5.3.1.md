---
title: 1. Composables
layout: home
nav_order: 1
parent: 5.3. Android avec Compose
permalink: /android-compose/composables/
code: 5.3.1
competence: C5
autoformation: "C5.3"
ua: "5.3.U1"
duree_h: 1.5
objectif: "Afficher texte, bouton, saisie et image puis prévisualiser l’écran avec @Preview."
notions_nouvelles: ["Composable", "Modifier", "@Preview", "TextField", "Button"]
fil_rouge: "HelloCounter — écran Hello + Compteur"
livrable_chapitre: "Écran combinant Text/Button/TextField/Image + 2 @Preview (Light/Dark)"
alimentation_prototype: "Briques UI de base prêtes pour la démo N2"
alimentation_miniprojet: "Composants réutilisables et préviews standardisées pour N3"
---


# 📘 5.3.1 - Composables essentiels

## 📒 Glossaire minute
- **Composable** : fonction annotée `@Composable` qui déclare un morceau d’UI.  
- **Modifier** : outil pour enchaîner des réglages visuels (taille, padding, clic, etc.).  
- **`@Preview`** : permet de visualiser un composable directement dans Android Studio, sans lancer l’app.  
- **State** : donnée qui change au cours du temps et qui déclenche la mise à jour automatique de l’UI.  
- **rememberSaveable** : fonction qui garde un état même si l’activité est recréée (ex. rotation d’écran).  

---

## 🎯 Objectif pédagogique
À partir de l’app **HelloCounter** déjà construite, comprendre :  
- comment un composable est défini,  
- comment il assemble d’autres composables,  
- comment l’état est géré avec `rememberSaveable`,  
- et comment prévisualiser un écran.

---

## 🧠 Explication à partir du code existant

### 1. `MainActivity`
Le point d’entrée de l’app. Elle applique le **thème** et appelle `MainScreen`.

```kotlin
class MainActivity : ComponentActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContent { HelloCounterTheme { MainScreen() } }
    }
}
````

👉 Ici, `setContent { ... }` attend un **composable racine** : on passe `MainScreen`.

---

### 2. `MainScreen`

Un composable **écran** qui assemble deux sections : `DireBonjourSection` et `CompteurSection`.

```kotlin
@Composable
fun MainScreen(modifier: Modifier = Modifier) {
    Column(
        modifier = modifier.fillMaxSize().padding(16.dp),
        verticalArrangement = Arrangement.spacedBy(24.dp),
        horizontalAlignment = Alignment.CenterHorizontally
    ) {
        DireBonjourSection()
        CompteurSection()
    }
}
```

👉 `Column` est lui-même un composable.
👉 `MainScreen` **ne dessine pas directement**, il **organise** d’autres composables.

---

### 3. `DireBonjourSection`

Un composable de section qui gère la **saisie du prénom** et l’affichage d’un **message**.

```kotlin
@Composable
fun DireBonjourSection(modifier: Modifier = Modifier) {
    var name by rememberSaveable { mutableStateOf("") }
    var greetingName by rememberSaveable { mutableStateOf<String?>(null) }

    Column(modifier = modifier.fillMaxWidth()) {
        OutlinedTextField(
            value = name,
            onValueChange = { ... },
            label = { Text(stringResource(R.string.label_firstname)) },
            placeholder = { Text(stringResource(R.string.ph_firstname)) }
        )

        Button(
            onClick = { greetingName = name.takeIf { it.isNotBlank() } },
            enabled = name.isNotBlank()
        ) {
            Text(stringResource(R.string.btn_greet))
        }

        if (greetingName != null) {
            AssistChip(onClick = { }, label = { Text("Bonjour $greetingName") })
        }
    }
}
```

👉 Ici, chaque élément (`OutlinedTextField`, `Button`, `AssistChip`) est un composable prêt à l’emploi.
👉 `DireBonjourSection` les combine pour former un **bloc fonctionnel**.

---

### 4. `CompteurSection`

Un composable qui gère un **compteur** avec boutons − et +.

```kotlin
@Composable
fun CompteurSection(modifier: Modifier = Modifier) {
    var count by rememberSaveable { mutableStateOf(0) }

    Row {
        IconButton(onClick = { if (count > 0) count-- }) {
            Icon(Icons.Filled.Remove, contentDescription = "Diminuer")
        }
        Text(text = "$count", style = MaterialTheme.typography.headlineSmall)
        IconButton(onClick = { count++ }) {
            Icon(Icons.Filled.Add, contentDescription = "Augmenter")
        }
    }
}
```

---

### 🔍 Focus sur `var count by rememberSaveable { mutableStateOf(0) }`

Décomposons ligne par ligne :

* **`var count`** → une variable mutable qui contient la valeur affichée dans l’UI.
* **`by`** → délégation : permet d’accéder directement à la valeur de l’état (`count`) au lieu d’écrire `count.value`.
* **`rememberSaveable`** → garde la valeur en mémoire même après une rotation d’écran. Sans ça, le compteur serait remis à 0.
* **`mutableStateOf(0)`** → crée un état observable initialisé à 0.
  Chaque fois que `count` change, Compose **recompose l’UI** et met à jour le texte.

👉 Résultat : le compteur reste cohérent et l’UI se met à jour automatiquement.

---

### 5. `@Preview`

Un composable spécial pour tester l’UI dans Android Studio.

```kotlin
@Preview(showBackground = true, widthDp = 360)
@Composable
fun PreviewMainScreen() {
    HelloCounterTheme { MainScreen() }
}
```

👉 Ici, pas besoin de lancer l’appli : on voit directement `MainScreen` dans l’éditeur.

---

## 🧾 Résumé et points-clés

* Un **composable** est une fonction annotée `@Composable`.
* Un **écran** (`MainScreen`) est une composition de plusieurs composables internes.
* L’**état** se gère avec `rememberSaveable { mutableStateOf(...) }`.
* `by` simplifie l’accès à la valeur de l’état.
* `@Preview` permet de tester sans exécuter l’app.

---

## 📦 Livrable attendu

Un **schéma d’explication** (écrit ou graphique) qui montre le lien entre :

* `MainActivity` → lance `MainScreen`,
* `MainScreen` → assemble `DireBonjourSection` et `CompteurSection`,
* chaque composable interne → utilise des briques comme `Text`, `Button`, `OutlinedTextField`, `IconButton`.

---

## ✅ Definition of Done

* [ ] L’apprenant sait **identifier un composable**.
* [ ] L’apprenant comprend le rôle de `rememberSaveable`.
* [ ] L’apprenant peut expliquer `var count by rememberSaveable { mutableStateOf(0) }`.
* [ ] L’apprenant sait lire une Preview et distinguer ce qui s’exécute dans l’app réelle.

---

