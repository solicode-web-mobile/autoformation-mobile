---
title: 5. Cycle « issue → feature → PR » 
permalink: /git-gitflow/cycle-issue-feature-pr/
layout: home
nav_order: 5
parent: 4.1. Git & GitFlow
---

# 📘 4.1.5 - Cycle « issue → feature → PR » 

## 📒 Glossaire minute
- **Issue** : ticket décrivant un besoin (User Story, bug, tâche).
- **Feature branch** : branche dédiée à l’issue (développement focalisé).
- **PR / MR** : Pull/Merge Request pour relire et fusionner la feature.
- **Closes #123** : mot-clé qui **ferme l’issue** à la fusion de la PR.

---

## ✅ Objectif
Appliquer un **flux court et lisible** : créer une issue claire, développer sur une **feature branch** avec **petits commits** liés à l’issue, puis ouvrir une **PR** propre (captures, checklist, CI verte) jusqu’au **merge (squash)**.

---

## 🔧 Pré-requis
- Règles de branches (voir **4.1.4**).
- Conventions de commits & outils lint/format (voir **4.1.2**).
- Scripts & doc d’installation (voir **4.1.3**).

---

## 1) Créer l’issue (User Story + critères)
**Gabarit recommandé**
```md
## Contexte
Pourquoi on fait ça ? (problème, valeur)

## User Story
En tant que <rôle>, je veux <action> afin de <bénéfice>.

## Critères d’acceptation (Given/When/Then)
- Given ...
- When ...
- Then ...

## Portée
- In scope : ...
- Out of scope : ...

## Notes techniques
Schéma, endpoints, migrations, perfs, risques…

## Tests
Cas à couvrir (unitaires, HTTP, e2e si besoin)

## Pièces jointes
Captures / wireframes / liens
````

**(Optionnel) via GitHub CLI**

```bash
gh issue create --title "Recherche: filtres q/tag/sort" --body-file issue.md --label feature
```

---

## 2) Créer la feature branch (liée à l’issue)

> Nommage : `feature/<id>-<slug>`

```bash
git checkout -b feature/321-recherche-filtrage develop
```

> Ajoute la référence de l’issue dans la **description de la branche** (sur la plateforme) ou dans la PR plus tard.

---

## 3) Commits **petits et fréquents** (liés à l’issue)

* Taille cible : **≤ 100–150 lignes** modifiées par commit/PR si possible.
* 1 commit = 1 **intention** (ajout, fix, refactor).
* Respecter **Conventional Commits** et **lier l’issue** :

  * Dans le **corps** du commit : `Refs #321`
  * Ou dans le **message** de PR : `Closes #321`

**Exemples**

```
feat(search): ajouter filtres q, tag, sort  (#321)
fix(search): corriger tri décroissant par défaut  (#321)
refactor(api): extraire service FilterBuilder  (#321)
test(http): couvrir 200/400 pour /articles?tag=  (#321)
```

**Rester aligné avec develop**

```bash
git fetch origin
git pull --rebase origin develop
# résoudre conflits puis:
git push --force-with-lease
```

---

## 4) Ouvrir la PR → `develop` (propre & vérifiable)

**Titre PR**

```
feat(search): filtres q/tag/sort (Closes #321)
```

**PR template (extrait)**

```md
## Objet
Courte description (quoi/pourquoi)

## Issue liée
Closes #321

## Captures / Démo
Avant/Après, GIF court si UI

## Checklists
- [ ] Lint/format OK (PHP/JS)
- [ ] Tests passent en local
- [ ] Doc/README/MIGRATIONS mis à jour si besoin
- [ ] Impacts perfs/UX évalués

## Tests
Cas couverts (unitaires/HTTP/e2e)
```

**Règles**

* CI **verte** (lint + tests).
* **Squash merge** par défaut (1 PR = 1 commit sur l’historique).
* **Review** : au moins **1 approbation** + corrections demandées traitées.
* Ajouter **captures**/logs de test quand c’est pertinent.

---

## 5) Merge & nettoyage

1. **Squash & merge** vers `develop`.
2. La PR **ferme** automatiquement l’issue via `Closes #321`.
3. Supprimer la **branche distante**.
4. (Si release en cours) **back-merge** après livraison (voir 4.1.4).

---

## 📦 Livrables attendus

* Issue complète (User Story, critères, notes techniques).
* Feature branch **nommée correctement**.
* Commits **petits**, **conventionnels**, **référencés** à l’issue.
* PR **propre** avec captures, checklist, CI verte.
* Issue **fermée** à la fusion.

---

## ✅ DoD — Definition of Done

* [ ] Tous les commits liés à **#ID** de l’issue.
* [ ] PR **feature → develop** en **squash**, **CI verte**.
* [ ] Critères d’acceptation **validés** (captures/tests).
* [ ] Branche supprimée, issue **fermée** automatiquement.

---

## 🩹 Erreurs fréquentes & correctifs

* ❌ PR trop grosse → **Découper** en plusieurs issues/PR thématiques.
* ❌ Commits “misc” → reformuler en **Conventional Commits**.
* ❌ Pas de lien issue → ajouter `Closes #ID` dans la PR (ou `Refs #ID` dans commits).
* ❌ Conflits tardifs → **rebase** régulier sur `develop`.
* ❌ CI rouge → corriger, relancer, documenter la cause.

---

## ⚡ Cheatsheet

```bash
# Issue -> feature
gh issue view 321
git checkout -b feature/321-recherche-filtrage develop

# Dev avec petits commits
git commit -m "feat(search): ajouter filtres q/tag/sort (#321)"
git commit -m "test(http): couvrir /articles?tag= (#321)"

# Rester à jour
git pull --rebase origin develop
git push --force-with-lease

# Ouvrir PR
gh pr create --base develop --title "feat(search): filtres q/tag/sort (Closes #321)" --body-file PR.md

# Après review
gh pr merge --squash

# Nettoyage (si non auto)
git branch -d feature/321-recherche-filtrage
git push origin :feature/321-recherche-filtrage
```

