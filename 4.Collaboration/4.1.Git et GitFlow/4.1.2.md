---
title: 2. Conventions
layout: home
nav_order: 2
parent: 4.1. Git & GitFlow
permalink: /git-gitflow/conventions-equipe/
code: 4.1.2
competence: C4
autoformation: "C4.1"
ua: "4.1.U1"
duree_h: 1.5
objectif: "Poser des conventions minimales (branches, commits, lint/format) et les automatiser."
notions_nouvelles: ["Conventional Commits", "EditorConfig", "ESLint", "Prettier", "Laravel Pint", "Husky", "lint-staged"]
fil_rouge: "Qualité homogène du code Blog/Mobile (lint/format + messages clairs)"
livrable_chapitre: ".editorconfig, configs ESLint/Prettier/Pint, scripts lint/format, hooks Husky, workflow lint"
alimentation_prototype: "CI de forme fiable pour branches de feature N2"
alimentation_miniprojet: "Règles partagées garantissant lisibilité et dette maîtrisée N3"
---


# 📘 4.1.2 - Conventions d’équipe

## 📒 Glossaire minute
- **Convention** : règle partagée pour garder un dépôt **lisible et homogène**.
- **Lint** : analyse statique qui **détecte** les erreurs de style ou de code.
- **Format** : réécriture automatique du code selon des **règles**.
- **Conventional Commits** : standard pour nommer les **messages de commit**.
- **EditorConfig** : fichier qui **synchronise** les réglages d’éditeur (indentation, fin de ligne…).

---

## ✅ Objectif
Adopter des **règles minimales & automatiques** pour : nommer les branches, écrire des commits **compréhensibles**, et **linter/formater** le code **sans débat** (l’outil tranche).

---

## 🔧 Pré-requis
- Avoir initialisé le dépôt (voir **4.1.1**).
- PHP 8.2+, Composer ; Node 18+.

---

## 🧭 Règles de branches (GitFlow minimal)
> **Toujours** ouvrir une PR → merge vers `develop` (ou `main` pour hotfix).

- **Branches stables** :  
  - `main` : production  
  - `develop` : intégration
- **Branches de travail** :  
  - `feature/<ticket-id>-<slug>` (ex. `feature/123-filtrer-projets`)  
  - `hotfix/<slug>` (ex. `hotfix/fix-500-login`)  
  - `release/<version>` (ex. `release/1.2.0`)
- **Règles** :
  - Pas de commit direct sur `main` ; merges via PR (squash).
  - Petits commits **fréquents** (≤ 100 lignes modifiées si possible).
  - Synchroniser avec `pull --rebase` avant de pousser.

**Exemples**
```bash
git checkout -b feature/456-pagination-notes
git commit -m "feat(notes): pagination côté serveur"
git push -u origin feature/456-pagination-notes
````

---

## 🗒️ Conventional Commits (messages de commit)

**Format**

```
<type>(<scope>)!?: <résumé impératif>
<ligne vide>
<corps optionnel (motivation, détails)>
<ligne vide>
BREAKING CHANGE: description optionnelle
```

**Types courants**

* `feat` (fonctionnalité), `fix` (correction), `docs`, `style` (sans logique),
* `refactor`, `perf`, `test`, `build`, `ci`, `chore`, `revert`.

**Exemples**

```
feat(auth): activer login via email ou username
fix(notes): corriger tri décroissant par défaut
docs(readme): ajouter section installation rapide
refactor(api): extraire service de pagination
perf(query): ajouter index composite sur (user_id, created_at)
test(http): couvrir 401/403 sur routes privées
```

---

## ⚙️ EditorConfig (règles d’éditeur)

Crée **.editorconfig** à la racine.

```ini
root = true

[*]
charset = utf-8
end_of_line = lf
insert_final_newline = true
indent_style = space
trim_trailing_whitespace = true

[*.php]
indent_size = 4

[{*.js,*.ts,*.json,*.yml,*.yaml,*.md}]
indent_size = 2

[Makefile]
indent_style = tab

[*.md]
trim_trailing_whitespace = false
```

---

## 🧼 Lint & Format — PHP (Laravel Pint)

**Installer Pint**

```bash
composer require laravel/pint --dev
```

**pint.json** (à la racine)

```json
{
  "preset": "laravel",
  "rules": {
    "ordered_imports": {"sort_algorithm": "alpha"},
    "no_unused_imports": true,
    "blank_line_after_opening_tag": true
  }
}
```

**Scripts Composer**

```json
{
  "scripts": {
    "lint:php": "vendor/bin/pint --test",
    "format:php": "vendor/bin/pint"
  }
}
```

---

## 🧹 Lint & Format — JS/TS (ESLint + Prettier)

**Installer**

```bash
npm i -D eslint prettier eslint-config-prettier eslint-plugin-import @typescript-eslint/parser @typescript-eslint/eslint-plugin
```

**.eslintrc.cjs**

```js
module.exports = {
  root: true,
  env: { es2022: true, node: true, browser: true },
  parser: "@typescript-eslint/parser",
  plugins: ["@typescript-eslint","import"],
  extends: [
    "eslint:recommended",
    "plugin:@typescript-eslint/recommended",
    "plugin:import/recommended",
    "plugin:import/typescript",
    "prettier"
  ],
  rules: {
    "import/order": ["warn",{ "alphabetize": { "order": "asc", "caseInsensitive": true } }],
    "no-unused-vars": "off",
    "@typescript-eslint/no-unused-vars": ["warn", { "argsIgnorePattern": "^_" }]
  }
}
```

**.prettierrc.json**

```json
{
  "printWidth": 100,
  "tabWidth": 2,
  "singleQuote": true,
  "trailingComma": "all",
  "semi": true
}
```

**Scripts npm**

```json
{
  "scripts": {
    "lint:js": "eslint . --ext .js,.ts --ignore-path .gitignore",
    "format:js": "prettier --write \"**/*.{js,ts,json,md,yml,yaml}\""
  }
}
```

---

## 📝 Lint Markdown & Blade (optionnel mais utile)

```bash
npm i -D markdownlint-cli blade-formatter
```

**.markdownlint.json**

```json
{
  "default": true,
  "MD013": false, 
  "MD033": false
}
```

**Scripts**

```json
{
  "scripts": {
    "lint:md": "markdownlint **/*.md",
    "format:blade": "blade-formatter \"resources/views/**/*.blade.php\" --write"
  }
}
```

---

## 🪝 Pré-commit (Husky + lint-staged)

**Installer**

```bash
npm i -D husky lint-staged
npx husky init
```

**package.json**

```json
{
  "lint-staged": {
    "*.{php}": ["composer lint:php --no-interaction", "git add"],
    "*.{js,ts}": ["npm run lint:js", "npm run format:js", "git add"],
    "*.md": ["npm run lint:md", "git add"],
    "**/*.blade.php": ["npm run format:blade", "git add"]
  }
}
```

**.husky/pre-commit**

```bash
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

npx lint-staged
```

---

## 🤖 CI (GitHub Actions — Lint rapide)

`.github/workflows/lint.yml`

```yml
name: Lint
on:
  pull_request:
    branches: [ develop, main ]
jobs:
  php-js-lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: PHP setup
        uses: shivammathur/setup-php@v2
        with:
          php-version: '8.2'

      - name: Install Composer deps
        run: composer install --no-interaction --prefer-dist

      - name: PHP Lint (Pint)
        run: vendor/bin/pint --test

      - name: Node setup
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install Node deps
        run: npm ci

      - name: ESLint
        run: npm run lint:js

      - name: Prettier check
        run: npx prettier -c "**/*.{js,ts,json,md,yml,yaml}"
```

---

## 📦 Livrables attendus

* `.editorconfig`, `.prettierrc.json`, `.eslintrc.cjs`, `.markdownlint.json`
* Scripts **Composer/NPM** pour `lint:` et `format:`
* Husky + lint-staged configurés
* Workflow CI de lint (`lint.yml`)
* Fichier **CONTRIBUTING.md** (rappel des conventions — optionnel)

---

## ✅ DoD — Definition of Done

* [ ] Branches nommées selon le **schéma** (`feature/…`, `hotfix/…`)
* [ ] Messages de commit **Conventional Commits**
* [ ] `composer lint:php` et `npm run lint:js` **passent** localement
* [ ] Hook **pre-commit** actif (Husky)
* [ ] CI **verte** sur la PR

---

## 🩹 Erreurs fréquentes & correctifs

* ❌ Commits “misc” / “fix” → **Reformuler** avec type + scope + verbe d’action.
* ❌ Conflits d’auto-format → laisser **Prettier/Pint** trancher, relancer format.
* ❌ Fin de ligne CRLF sous Windows → `.editorconfig` avec `end_of_line = lf`.
* ❌ Fichiers volumineux modifiés en masse → isoler **format** dans un commit dédié.

---

## ⚡ Cheatsheet

```bash
# Branches
git checkout -b feature/321-recherche-filtrage
git pull --rebase origin develop

# Commits
git commit -m "feat(search): filtres q, tag, sort par défaut"

# Lint/format
composer lint:php && composer format:php
npm run lint:js && npm run format:js

# Husky (si besoin de réinstaller)
npx husky init && git add .husky && git commit -m "chore: enable husky"
```