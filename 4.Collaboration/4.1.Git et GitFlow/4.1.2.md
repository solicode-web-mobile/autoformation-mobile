---
title: 2. Conventions
layout: home
nav_order: 2
parent: 4.1. Git & GitFlow
permalink: /git-gitflow/conventions-equipe/
code: 4.1.2
competence: C4
autoformation: "C4.1"
ua: "4.1.U1"
duree_h: 1.5
objectif: "Poser des conventions minimales (branches, commits, lint/format) et les automatiser."
notions_nouvelles: ["Conventional Commits", "EditorConfig", "ESLint", "Prettier", "Laravel Pint", "Husky", "lint-staged"]
fil_rouge: "QualitÃ© homogÃ¨ne du code Blog/Mobile (lint/format + messages clairs)"
livrable_chapitre: ".editorconfig, configs ESLint/Prettier/Pint, scripts lint/format, hooks Husky, workflow lint"
alimentation_prototype: "CI de forme fiable pour branches de feature N2"
alimentation_miniprojet: "RÃ¨gles partagÃ©es garantissant lisibilitÃ© et dette maÃ®trisÃ©e N3"
---


# ğŸ“˜ 4.1.2 - Conventions dâ€™Ã©quipe

## ğŸ“’ Glossaire minute
- **Convention** : rÃ¨gle partagÃ©e pour garder un dÃ©pÃ´t **lisible et homogÃ¨ne**.
- **Lint** : analyse statique qui **dÃ©tecte** les erreurs de style ou de code.
- **Format** : rÃ©Ã©criture automatique du code selon des **rÃ¨gles**.
- **Conventional Commits** : standard pour nommer les **messages de commit**.
- **EditorConfig** : fichier qui **synchronise** les rÃ©glages dâ€™Ã©diteur (indentation, fin de ligneâ€¦).

---

## âœ… Objectif
Adopter des **rÃ¨gles minimales & automatiques** pour : nommer les branches, Ã©crire des commits **comprÃ©hensibles**, et **linter/formater** le code **sans dÃ©bat** (lâ€™outil tranche).

---

## ğŸ”§ PrÃ©-requis
- Avoir initialisÃ© le dÃ©pÃ´t (voir **4.1.1**).
- PHP 8.2+, Composer ; Node 18+.

---

## ğŸ§­ RÃ¨gles de branches (GitFlow minimal)
> **Toujours** ouvrir une PR â†’ merge vers `develop` (ou `main` pour hotfix).

- **Branches stables** :  
  - `main` : production  
  - `develop` : intÃ©gration
- **Branches de travail** :  
  - `feature/<ticket-id>-<slug>` (ex. `feature/123-filtrer-projets`)  
  - `hotfix/<slug>` (ex. `hotfix/fix-500-login`)  
  - `release/<version>` (ex. `release/1.2.0`)
- **RÃ¨gles** :
  - Pas de commit direct sur `main` ; merges via PR (squash).
  - Petits commits **frÃ©quents** (â‰¤ 100 lignes modifiÃ©es si possible).
  - Synchroniser avec `pull --rebase` avant de pousser.

**Exemples**
```bash
git checkout -b feature/456-pagination-notes
git commit -m "feat(notes): pagination cÃ´tÃ© serveur"
git push -u origin feature/456-pagination-notes
````

---

## ğŸ—’ï¸ Conventional Commits (messages de commit)

**Format**

```
<type>(<scope>)!?: <rÃ©sumÃ© impÃ©ratif>
<ligne vide>
<corps optionnel (motivation, dÃ©tails)>
<ligne vide>
BREAKING CHANGE: description optionnelle
```

**Types courants**

* `feat` (fonctionnalitÃ©), `fix` (correction), `docs`, `style` (sans logique),
* `refactor`, `perf`, `test`, `build`, `ci`, `chore`, `revert`.

**Exemples**

```
feat(auth): activer login via email ou username
fix(notes): corriger tri dÃ©croissant par dÃ©faut
docs(readme): ajouter section installation rapide
refactor(api): extraire service de pagination
perf(query): ajouter index composite sur (user_id, created_at)
test(http): couvrir 401/403 sur routes privÃ©es
```

---

## âš™ï¸ EditorConfig (rÃ¨gles dâ€™Ã©diteur)

CrÃ©e **.editorconfig** Ã  la racine.

```ini
root = true

[*]
charset = utf-8
end_of_line = lf
insert_final_newline = true
indent_style = space
trim_trailing_whitespace = true

[*.php]
indent_size = 4

[{*.js,*.ts,*.json,*.yml,*.yaml,*.md}]
indent_size = 2

[Makefile]
indent_style = tab

[*.md]
trim_trailing_whitespace = false
```

---

## ğŸ§¼ Lint & Format â€” PHP (Laravel Pint)

**Installer Pint**

```bash
composer require laravel/pint --dev
```

**pint.json** (Ã  la racine)

```json
{
  "preset": "laravel",
  "rules": {
    "ordered_imports": {"sort_algorithm": "alpha"},
    "no_unused_imports": true,
    "blank_line_after_opening_tag": true
  }
}
```

**Scripts Composer**

```json
{
  "scripts": {
    "lint:php": "vendor/bin/pint --test",
    "format:php": "vendor/bin/pint"
  }
}
```

---

## ğŸ§¹ Lint & Format â€” JS/TS (ESLint + Prettier)

**Installer**

```bash
npm i -D eslint prettier eslint-config-prettier eslint-plugin-import @typescript-eslint/parser @typescript-eslint/eslint-plugin
```

**.eslintrc.cjs**

```js
module.exports = {
  root: true,
  env: { es2022: true, node: true, browser: true },
  parser: "@typescript-eslint/parser",
  plugins: ["@typescript-eslint","import"],
  extends: [
    "eslint:recommended",
    "plugin:@typescript-eslint/recommended",
    "plugin:import/recommended",
    "plugin:import/typescript",
    "prettier"
  ],
  rules: {
    "import/order": ["warn",{ "alphabetize": { "order": "asc", "caseInsensitive": true } }],
    "no-unused-vars": "off",
    "@typescript-eslint/no-unused-vars": ["warn", { "argsIgnorePattern": "^_" }]
  }
}
```

**.prettierrc.json**

```json
{
  "printWidth": 100,
  "tabWidth": 2,
  "singleQuote": true,
  "trailingComma": "all",
  "semi": true
}
```

**Scripts npm**

```json
{
  "scripts": {
    "lint:js": "eslint . --ext .js,.ts --ignore-path .gitignore",
    "format:js": "prettier --write \"**/*.{js,ts,json,md,yml,yaml}\""
  }
}
```

---

## ğŸ“ Lint Markdown & Blade (optionnel mais utile)

```bash
npm i -D markdownlint-cli blade-formatter
```

**.markdownlint.json**

```json
{
  "default": true,
  "MD013": false, 
  "MD033": false
}
```

**Scripts**

```json
{
  "scripts": {
    "lint:md": "markdownlint **/*.md",
    "format:blade": "blade-formatter \"resources/views/**/*.blade.php\" --write"
  }
}
```

---

## ğŸª PrÃ©-commit (Husky + lint-staged)

**Installer**

```bash
npm i -D husky lint-staged
npx husky init
```

**package.json**

```json
{
  "lint-staged": {
    "*.{php}": ["composer lint:php --no-interaction", "git add"],
    "*.{js,ts}": ["npm run lint:js", "npm run format:js", "git add"],
    "*.md": ["npm run lint:md", "git add"],
    "**/*.blade.php": ["npm run format:blade", "git add"]
  }
}
```

**.husky/pre-commit**

```bash
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

npx lint-staged
```

---

## ğŸ¤– CI (GitHub Actions â€” Lint rapide)

`.github/workflows/lint.yml`

```yml
name: Lint
on:
  pull_request:
    branches: [ develop, main ]
jobs:
  php-js-lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: PHP setup
        uses: shivammathur/setup-php@v2
        with:
          php-version: '8.2'

      - name: Install Composer deps
        run: composer install --no-interaction --prefer-dist

      - name: PHP Lint (Pint)
        run: vendor/bin/pint --test

      - name: Node setup
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install Node deps
        run: npm ci

      - name: ESLint
        run: npm run lint:js

      - name: Prettier check
        run: npx prettier -c "**/*.{js,ts,json,md,yml,yaml}"
```

---

## ğŸ“¦ Livrables attendus

* `.editorconfig`, `.prettierrc.json`, `.eslintrc.cjs`, `.markdownlint.json`
* Scripts **Composer/NPM** pour `lint:` et `format:`
* Husky + lint-staged configurÃ©s
* Workflow CI de lint (`lint.yml`)
* Fichier **CONTRIBUTING.md** (rappel des conventions â€” optionnel)

---

## âœ… DoD â€” Definition of Done

* [ ] Branches nommÃ©es selon le **schÃ©ma** (`feature/â€¦`, `hotfix/â€¦`)
* [ ] Messages de commit **Conventional Commits**
* [ ] `composer lint:php` et `npm run lint:js` **passent** localement
* [ ] Hook **pre-commit** actif (Husky)
* [ ] CI **verte** sur la PR

---

## ğŸ©¹ Erreurs frÃ©quentes & correctifs

* âŒ Commits â€œmiscâ€ / â€œfixâ€ â†’ **Reformuler** avec type + scope + verbe dâ€™action.
* âŒ Conflits dâ€™auto-format â†’ laisser **Prettier/Pint** trancher, relancer format.
* âŒ Fin de ligne CRLF sous Windows â†’ `.editorconfig` avec `end_of_line = lf`.
* âŒ Fichiers volumineux modifiÃ©s en masse â†’ isoler **format** dans un commit dÃ©diÃ©.

---

## âš¡ Cheatsheet

```bash
# Branches
git checkout -b feature/321-recherche-filtrage
git pull --rebase origin develop

# Commits
git commit -m "feat(search): filtres q, tag, sort par dÃ©faut"

# Lint/format
composer lint:php && composer format:php
npm run lint:js && npm run format:js

# Husky (si besoin de rÃ©installer)
npx husky init && git add .husky && git commit -m "chore: enable husky"
```