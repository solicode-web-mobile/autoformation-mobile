---
title: 7. Ouvrir une PR 
permalink: /git-gitflow/ouvrir-pr/
layout: home
nav_order: 7
parent: 4.1. Git & GitFlow
---

# ğŸ“˜ 4.1.7 - Ouvrir une PR 

## ğŸ“’ Glossaire minute
- **PR/MR** : demande de fusion pour relire et intÃ©grer du code.
- **Draft PR** : PR brouillon, non prÃªte Ã  merger (collecte de feedback).
- **Owner/Reviewer** : auteur / relecteur(s) de la PR.
- **Checks** : validations CI (lint, tests) obligatoires avant merge.

---

## âœ… Objectif
CrÃ©er une **PR claire, testÃ©e et vÃ©rifiable** : description concise, **captures**, **checklist** cochÃ©e, **issue liÃ©e** (`Closes #ID`) et **CI verte** pour permettre un **squash merge** sans risque.

---

## ğŸ”§ PrÃ©-requis
- StratÃ©gie de branches (voir **4.1.4**).
- Conventions commits/lint/format (voir **4.1.2**).
- Scripts & setup projet OK (voir **4.1.3**).
- Sync propre via rebase avant PR (voir **4.1.6**).

---

## 1) Avant dâ€™ouvrir la PR (auto-revue rapide)
- [ ] Rebase sur `origin/develop` et push avec `--force-with-lease`.  
- [ ] Lancer les tests **en local** : `composer test`.  
- [ ] Lint/format : `composer lint:php`, `npm run lint:js`.  
- [ ] VÃ©rifier la taille de la PR (viser petit : **â‰¤ 300 lignes** modifiÃ©es, **â‰¤ 5â€“7 fichiers**).  
- [ ] Mettre Ã  jour **README/Docs/Migrations** si nÃ©cessaire.

---

## 2) Titre & description de la PR

**Titre (pattern recommandÃ©)**
```

feat(scope): courte phrase impact utilisateur (Closes #321)

```

**Exemples**
```

feat(search): filtres q/tag/sort (Closes #321)
fix(auth): empÃªcher brute force login (Closes #512)
docs(readme): procÃ©dure setup Docker

````

**Description (sections minimales)**
```md
## Objet
[Quoi / Pourquoi] â€” valeur livrÃ©e, contexte court.

## Issue liÃ©e
Closes #321

## Captures / DÃ©mo
Avant/AprÃ¨s, GIF court (si UI)

## Notes techniques
Migrations, services, endpoints, perf, breaking changes Ã©ventuels.

## Tests
Cas couverts (unitaires/HTTP/e2e) + commandes.

## Checklist
- [ ] Lint/format OK (PHP/JS)
- [ ] Tests passent en local + CI verte
- [ ] Docs/README mis Ã  jour si besoin
- [ ] Pas de secret dans le code / logs
````

---

## 3) Captures & dÃ©mo (si UI)

* Inclure **2â€“3 captures** maximum (Avant/AprÃ¨s).
* GIF â‰¤ 10s pour une interaction clÃ©.
* Si API : coller **exemples de requÃªtes/rÃ©ponses** (curl ou Postman export mini).

---

## 4) Lier lâ€™issue (fermeture auto)

* Fermer automatiquement : `Closes #321` (dans **la PR**).
* RÃ©fÃ©rencer sans fermer : `Refs #654`.
* Plusieurs issues : `Closes #1, Closes #2`.

---

## 5) Review : attentes & rÃ©ponses

* Demander **1+ reviewer**.
* RÃ©pondre point par point, pousser des **commits ciblÃ©s**.
* PrÃ©fÃ©rer les **suggestions de code** quand câ€™est trivial.
* Si la PR devient trop grosse â†’ **scinder**.

---

## 6) Labels, milestones, protection

* Labeliser : `feature`, `bug`, `docs`, `hotfix`, `breaking`.
* Milestone : associer Ã  la **release** en cours.
* Branches `main/develop` **protÃ©gÃ©es** : PR obligatoire + CI verte.

---

## 7) CI & checks attendus

* **Obligatoires** : lint PHP/JS, tests (Pest/PHPUnit, HTTP).
* Optionnels : coverage snapshot, build preview.
* Relancer un job flaky : â€œRe-run jobsâ€ (Ã©viter de merger CI rouge).

---

## 8) Merge & nettoyage

* Politique par dÃ©faut : **Squash merge**.
* Supprimer la branche **aprÃ¨s merge**.
* Release/Hotfix : tag sur `main` + **back-merge** vers `develop`.

---

## 9) ModÃ¨le de PR (fichier recommandÃ©)

CrÃ©er `.github/pull_request_template.md` :

```md
## Objet
[Quoi / Pourquoi â€” impact utilisateur]

## Issue liÃ©e
Closes #ID

## Captures / DÃ©mo
[Avant/AprÃ¨s, GIF â‰¤10s]

## Notes techniques
[Migrations / endpoints / perfs / risques / breaking]

## Tests
- [ ] Unitaires
- [ ] HTTP/Feature
- [ ] e2e (si pertinent)

## Checklist
- [ ] Lint/format OK (PHP/JS)
- [ ] CI verte
- [ ] Docs/README Ã  jour si besoin
- [ ] Pas de secrets / credentials
- [ ] Migration rÃ©versible (up/down)
```

---

## ğŸ“¦ Livrables attendus

* PR avec **titre** conventionnel + **description** structurÃ©e.
* **Captures/DÃ©mo** quand lâ€™UI change.
* **Checklist** cochÃ©e, **issue liÃ©e**.
* **CI verte**, prÃªte pour **squash merge**.

---

## âœ… DoD â€” Definition of Done

* [ ] `Closes #ID` prÃ©sent dans le **titre** ou la **description**.
* [ ] PR **petite**, **focus**, CI **verte**.
* [ ] Captures/Exemples fournis si UI/API.
* [ ] Squash merge effectuÃ© + branche supprimÃ©e.

---

## ğŸ©¹ Erreurs frÃ©quentes & correctifs

* âŒ PR trop large â†’ dÃ©couper en **plusieurs PR**.
* âŒ Pas de lien issue â†’ ajouter `Closes #ID`.
* âŒ CI rouge â†’ corriger localement, push, **re-run**.
* âŒ Manque de contexte â†’ complÃ©ter **Objet** + **Notes techniques**.
* âŒ Migrations non rÃ©versibles â†’ ajouter `down()` correct.

---

## âš¡ Cheatsheet (GitHub CLI)

```bash
# CrÃ©er une PR depuis la branche courante vers develop
gh pr create --base develop \
  --title "feat(search): filtres q/tag/sort (Closes #321)" \
  --body-file .github/PR_BODY.md \
  --label feature

# Marquer en draft / prÃªt pour review
gh pr ready --undo   # repasse en Draft
gh pr ready         # passe en Ready for review

# Assigner reviewers
gh pr edit --add-reviewer username1 --add-reviewer username2

# Merger en squash (CI verte requise)
gh pr merge --squash
```
